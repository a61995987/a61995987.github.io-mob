(function(){"use strict";var t={3534:function(t,e,a){var i=a(6848),s=function(){var t=this,e=t._self._c;return e("div",{attrs:{id:"app"}},[t._m(0),"/"!=t.$route.path?e("menuBox",{attrs:{userInfo:t.userInfo}}):t._e(),e("div",{class:"/"!=t.$route.path?"routeView body":"routeView"},[e("router-view",{style:"/"==t.$route.path?"":"margin-top:calc(60px + 1px + 40px);margin-bottom: 40px;"})],1),"/"!=t.$route.path?e("footerBox"):t._e(),e("div",{directives:[{name:"show",rawName:"v-show",value:t.mask,expression:"mask"}],ref:"mask",staticClass:"mask",style:t.maskStyle,on:{click:t.clickMask}}),t.isShowLogin?e("loginBox",{on:{hide:t.closeLogin,appeal:t.openAppeal}}):t._e(),t.isShowReg?e("regBox",{on:{hide:function(e){t.isShowReg=!1}}}):t._e(),t.isShowAppealBox?e("appealBox",{attrs:{reason:t.banReason,username:t.banUsername},on:{hide:t.closeAppeal}}):t._e(),t.isNetERR?e("div",{staticClass:"netError"},[e("div",{staticClass:"title"},[t._v("网络错误")]),e("div",{staticClass:"text"},[t._v("鹤儿迷路了，正在寻找信号…")]),e("div",{staticClass:"btnGroup"},[e("div",{staticClass:"btn",on:{click:function(e){return t.refresh()}}},[e("img",{attrs:{src:t.logo}}),t._v("重新连接 ")])])]):t._e(),t.loading?e("div",{staticClass:"loadingBg"},[e("div",{staticClass:"loading"},[e("div",{staticClass:"imgBox"},[e("img",{staticClass:"imgOuter loading-animation",attrs:{src:t.loadingIcon}}),e("div",{staticClass:"text"},[t._v("加载中")])])])]):t._e()],1)},o=[function(){var t=this,e=t._self._c;return e("div",{staticClass:"siteloading",attrs:{id:"siteloading"}},[e("div",{staticClass:"logoBox"},[e("img",{staticClass:"logo",attrs:{src:"/logo.png"}})]),e("div",{staticClass:"textBox"},[e("img",{staticClass:"icon loading-animation",attrs:{src:"/loading.svg"}}),e("div",{staticClass:"text hide"})])])}],l=(a(4114),a.p+"img/logo.7357e96d.png"),n=a.p+"img/loading.a18f5901.svg",r=function(){var t=this,e=t._self._c;return e("div",{attrs:{id:"regBox"}},[e("dialogLib",{attrs:{title:"注册千鹤",titleSize:"2rem",height:"auto"},on:{hide:function(e){return t.$emit("hide",!0)}}},[e("div",{staticClass:"regForm"},[e("label",[t._v("用户名/邮箱(必填)")]),e("input",{directives:[{name:"model",rawName:"v-model",value:t.regForm.username,expression:"regForm.username"}],attrs:{type:"text",placeholder:"请输入用户名/邮箱"},domProps:{value:t.regForm.username},on:{keypress:function(e){return!e.type.indexOf("key")&&t._k(e.keyCode,"enter",13,e.key,"Enter")?null:t.reg()},input:function(e){e.target.composing||t.$set(t.regForm,"username",e.target.value)}}}),e("label",[t._v("密码(必填)")]),e("input",{directives:[{name:"model",rawName:"v-model",value:t.regForm.password,expression:"regForm.password"}],attrs:{type:"password",placeholder:"请输入密码"},domProps:{value:t.regForm.password},on:{keypress:function(e){return!e.type.indexOf("key")&&t._k(e.keyCode,"enter",13,e.key,"Enter")?null:t.reg()},input:function(e){e.target.composing||t.$set(t.regForm,"password",e.target.value)}}}),e("label",[t._v("确认密码(必填)")]),e("input",{directives:[{name:"model",rawName:"v-model",value:t.regForm.rePassword,expression:"regForm.rePassword"}],attrs:{type:"password",placeholder:"请再次输入密码"},domProps:{value:t.regForm.rePassword},on:{keypress:function(e){return!e.type.indexOf("key")&&t._k(e.keyCode,"enter",13,e.key,"Enter")?null:t.reg()},input:function(e){e.target.composing||t.$set(t.regForm,"rePassword",e.target.value)}}}),e("label",[t._v("邮箱(必填)")]),e("input",{directives:[{name:"model",rawName:"v-model",value:t.regForm.email,expression:"regForm.email"}],class:t.disableEmail?"email disableEmail":"email",attrs:{disabled:t.disableEmail,type:"email",placeholder:"请输入邮箱"},domProps:{value:t.regForm.email},on:{keypress:function(e){return!e.type.indexOf("key")&&t._k(e.keyCode,"enter",13,e.key,"Enter")?null:t.login()},input:function(e){e.target.composing||t.$set(t.regForm,"email",e.target.value)}}}),t.hideHcaptcha?t._e():e("div",{staticClass:"alerts"},[t._v(" 完成人机验证以发送邮件 ")]),e("label",[t._v("邮箱验证码(必填)")]),t.hideHcaptcha?t._e():e("div",{staticClass:"code"},[e("vue-hcaptcha",{attrs:{sitekey:t.hCaptchaKey,size:t.hideHcaptcha?"invisible":"normal"},on:{verify:t.hcapResult}})],1),e("input",{directives:[{name:"model",rawName:"v-model",value:t.regForm.emailCode,expression:"regForm.emailCode"}],attrs:{type:"email",placeholder:"请输入您收到的验证码"},domProps:{value:t.regForm.emailCode},on:{keypress:function(e){return!e.type.indexOf("key")&&t._k(e.keyCode,"enter",13,e.key,"Enter")?null:t.reg()},input:function(e){e.target.composing||t.$set(t.regForm,"emailCode",e.target.value)}}}),e("qhButton",{attrs:{btnClass:"finishBtn",text:"完成注册"},on:{click:function(e){return t.reg()}}}),e("div",{staticClass:"btnGroup"},[e("div",{staticClass:"btn",on:{click:function(e){return t.$root.goLogin()}}},[t._v("去登录")]),e("div",{staticClass:"btn active"},[t._v("注册")])])],1)])],1)},c=[],d=a(1372),h=a.n(d),u=a(4373),m=function(){var t=this,e=t._self._c;return e("div",{class:t.btnClass,attrs:{id:"buttonLib"}},[e("button",{class:t.classList,style:t.sizeStyle,attrs:{disabled:t.disabled},on:{click:t.clickEvent}},[e("div",{staticClass:"text"},[t._v(t._s(t.text))])])])},g=[],p={props:{btnClass:{type:String,default:""},text:{type:String,default:"这是一个按钮"},disabled:{type:Boolean,default:!1},isActive:{type:Boolean,default:!1},size:{type:String,default:"normal"}},watch:{isActive:{handler(t){t?this.classList+=" active":this.classList=this.classList.replace(" active","")},deep:!0,immediate:!0},disabled:{handler(t){t?this.classList+=" disabled":this.classList=this.classList.replace(" disabled","")},deep:!0,immediate:!0},size:{handler(t){this.sizeStyle="small"!=t?"large"!=t?"":"padding:15px":"padding:5px"},deep:!0,immediate:!0}},data(){return{classList:"qhbtn",sizeStyle:""}},methods:{clickEvent:function(){this.disabled||this.$emit("click")}},mounted(){},created(){}},f=p,v=a(1656),C=(0,v.A)(f,m,g,!1,null,"287d9132",null),b=C.exports,w=function(){var t=this,e=t._self._c;return e("div",{ref:"dialog_"+t.zIndex,staticClass:"dialog card",style:t.buildStyle},[e("div",{staticClass:"cardTitle",style:"font-size:"+t.titleSize},[e("div",{staticClass:"text"},[t._v(t._s(t.title))]),t.isShowClose?e("closeLib",{attrs:{size:"3rem"},on:{click:t.hide}}):t._e()],1),e("div",{staticClass:"content"},[t._t("default")],2)])},_=[],y=(a(8992),a(3949),function(){var t=this,e=t._self._c;return e("div",{staticClass:"close",style:"width:"+t.size+";height:"+t.size,on:{click:function(e){return t.$emit("click")}}})}),k=[],x={name:"closeLib",props:{size:{type:String,default:"2rem"}}},$=x,L=(0,v.A)($,y,k,!1,null,"315fbfe2",null),S=L.exports,D={name:"dialogLib",components:{closeLib:S},computed:{buildStyle(){let t="";return t+="width:"+this.width+";",t+="height:"+this.height+";",t+="max-height:"+this.maxHeight+";",t+="max-width:"+this.maxWidth+";",t+="z-index:"+this.zIndex+";",""!=this.top?(t+="transform:translate(-50%, 0);",t+="top:"+this.top+";"):t+="transform:translate(-50%, -50%);",t}},props:{title:{type:String,default:""},titleSize:{type:String,default:"1.4rem"},width:{type:String,default:"calc(100% - 40px - 20px);"},maxWidth:{type:String,default:"unset"},height:{type:String,default:"calc(70vh - 80px)"},maxHeight:{type:String,default:"70vh"},top:{type:String,default:""},isShowClose:{type:Boolean,default:!0},hideWithMask:{type:Boolean,default:!0}},data:function(){return{zIndex:8,maskClickHandler:()=>{let t=document.querySelectorAll(".dialog"),e=0,a=null;t.forEach((t=>{let i=parseInt(t.style.zIndex)||0;i>e&&(e=i,a=t)})),this.$refs["dialog_"+this.zIndex]===a&&this.hide()}}},methods:{openListener(){let t=document.querySelector(".mask");t&&t.addEventListener("click",this.maskClickHandler)},hide(){let t="dialog_"+this.zIndex;this.$refs[t]?.classList.remove("active");let e=document.querySelector(".mask");if(null!=e&&(e.style.zIndex=""),this.hideWithMask)return this.$root.enableMask(!1),void setTimeout((()=>{this.$emit("hide",!0)}),300);this.$emit("hide",!0)},show(){let t="dialog_"+this.zIndex;this.$refs[t]?.classList.add("active")},setIndex(){let t=document.querySelectorAll(".dialog"),e=0;for(let i=0;i<t.length;i++){let a=parseInt(t[i].style.zIndex);a>e&&(e=a)}let a=document.querySelector(".mask");null!=a&&(a.style.zIndex=e),this.zIndex=e+1}},mounted(){this.$nextTick((()=>{this.$root.enableMask(!0),setTimeout((()=>{this.show(),this.openListener()}),5),this.setIndex()}))},beforeDestroy(){let t=document.querySelector(".mask");t&&this.maskClickHandler&&t.removeEventListener("click",this.maskClickHandler)}},F=D,A=(0,v.A)(F,w,_,!1,null,"0ac71842",null),T=A.exports,P={name:"regBox",components:{VueHcaptcha:h(),qhButton:b,dialogLib:T},watch:{"regForm.email":{handler(t){""==t?(this.disableEmail=!1,this.hideHcaptcha=!0):-1!=t.indexOf("@")&&-1!=t.indexOf(".")?this.hideHcaptcha=!1:this.hideHcaptcha=!0},immediate:!0,deep:!0}},data(){return{URL:window.config.apiUrl,hCaptchaKey:window.config.hCaptcha,regForm:{code:"",username:"",password:"",rePassword:"",email:"",emailCode:""},disableEmail:!1,hideHcaptcha:!0}},methods:{hcapResult(t){this.regForm.code=t,t&&(this.hideHcaptcha=!0,this.sendMail())},sendMail(){if(""==this.regForm.email)return void this.$notify.error({title:"提示",message:"请填写邮箱",offset:this.$root.notifyOffet});if(!this.regForm.email.match(/^[a-zA-Z0-9_-]+@[a-zA-Z0-9_-]+(\.[a-zA-Z0-9_-]+)+$/))return void this.$notify.error({title:"提示",message:"邮箱格式错误",offset:this.$root.notifyOffet});if(""==this.regForm.code)return void this.$notify.error({title:"提示",message:"请先通过人机验证",offset:this.$root.notifyOffet});this.$root.loading(!0);let t={email:this.regForm.email,id:"reg",code:this.regForm.code};u.A.post(this.URL+"/user/sendMail",t).then((t=>{let e=t.data??null;if(-1==e.code)return this.$notify.error({title:"提示",message:e.msg,offset:this.$root.notifyOffet}),this.$root.loading(!1),void(this.hideHcaptcha=!1);this.disableEmail=!0,this.$root.loading(!1),this.$notify.success({title:"提示",message:e.msg,offset:this.$root.notifyOffet})})).catch((t=>{this.hideHcaptcha=!1,this.$root.loading(!1),this.$emit("hide",!0),this.$nextTick((()=>{this.$root.netError(t)}))}))},reg(){""!=this.regForm.username&&""!=this.regForm.password&&""!=this.regForm.rePassword&&""!=this.regForm.email&&""!=this.regForm.emailCode?this.regForm.password==this.regForm.rePassword?-1!=this.regForm.email.indexOf("@")&&-1!=this.regForm.email.indexOf(".")?(this.$root.loading(!0),this.regForm.code=this.regForm.emailCode,u.A.post(this.URL+"/user/register",this.regForm).then((t=>{let e=t.data??null;if(-1==e.code)return this.$notify.error({message:e.msg,offset:this.$root.notifyOffet}),void this.$root.loading(!1);this.$root.loading(!1),this.$nextTick((()=>{this.$notify.success({title:"提示",message:"注册成功",offset:this.$root.notifyOffet}),this.$root.goLogin()}))})).catch((t=>{this.$root.loading(!1),this.$nextTick((()=>{this.$root.netError(t)}))}))):this.$notify.error({title:"提示",message:"邮箱格式错误",offset:this.$root.notifyOffet}):this.$notify.error({title:"提示",message:"两次密码不一致",offset:this.$root.notifyOffet}):this.$notify.error({title:"提示",message:"请填写完整信息",offset:this.$root.notifyOffet})}}},I=P,B=(0,v.A)(I,r,c,!1,null,"de7f6fa4",null),E=B.exports,R=function(){var t=this,e=t._self._c;return e("div",{attrs:{id:"loginBox"}},[e("dialogLib",{ref:"login",attrs:{title:"登录千鹤",titleSize:"2rem",height:"auto"},on:{hide:function(e){return t.$emit("hide",!0)}}},[e("div",{staticClass:"loginForm"},[e("label",[t._v("用户名/邮箱")]),e("input",{directives:[{name:"model",rawName:"v-model",value:t.loginForm.username,expression:"loginForm.username"}],attrs:{type:"text",placeholder:"请输入用户名/邮箱"},domProps:{value:t.loginForm.username},on:{input:function(e){e.target.composing||t.$set(t.loginForm,"username",e.target.value)}}}),e("label",[t._v("密码")]),e("input",{directives:[{name:"model",rawName:"v-model",value:t.loginForm.password,expression:"loginForm.password"}],attrs:{type:"password",placeholder:"请输入密码"},domProps:{value:t.loginForm.password},on:{input:function(e){e.target.composing||t.$set(t.loginForm,"password",e.target.value)}}}),t.hideHcaptcha?t._e():e("div",{staticClass:"alerts"},[t._v(" 完成人机验证以登录 ")]),t.hideHcaptcha?t._e():e("div",{staticClass:"code"},[e("vue-hcaptcha",{attrs:{sitekey:t.hCaptchaKey,size:t.hideHcaptcha?"invisible":"normal"},on:{verify:t.hcapResult}})],1),e("div",{staticClass:"btnGroup"},[e("div",{staticClass:"btn active"},[t._v("登录")]),e("div",{staticClass:"btn",on:{click:function(e){return t.$root.goReg()}}},[t._v("去注册")])])])])],1)},N=[],U={name:"loginBox",components:{VueHcaptcha:h(),dialogLib:T},data(){return{loginForm:{username:"",password:"",code:""},URL:window.config.apiUrl,hCaptchaKey:window.config.hCaptcha,hideHcaptcha:!0}},watch:{loginForm:{handler(t){""!=t.username&&""!=t.password?this.hideHcaptcha=!1:this.hideHcaptcha=!0},immediate:!0,deep:!0}},methods:{hcapResult(t){this.loginForm.code=t,t&&(this.hideHcaptcha=!0,this.login())},login(){if(""==this.loginForm.username||""==this.loginForm.password)return this.$notify.error({title:"提示",message:"请填写完整信息",offset:this.$root.notifyOffet}),this.hideHcaptcha=!0,this.$nextTick((()=>{this.hideHcaptcha=!1})),void(this.loginForm={username:"",password:"",code:""});""!=this.loginForm.code?(this.$root.loading(!0),u.A.post(this.URL+"/user/login",this.loginForm).then((t=>{let e=t.data??null;return-1==e.code?(this.$notify.error({title:"提示",message:e.msg,offset:this.$root.notifyOffet}),this.$root.loading(!1),this.$root.enableMask(!1),this.hideHcaptcha=!0,void this.$nextTick((()=>{this.hideHcaptcha=!1}))):-2==e.code?(this.$root.loading(!1),this.hideHcaptcha=!1,void this.$emit("appeal",e?.msg,this.loginForm.username)):(this.$root.enableMask(!1),this.$root.loading(!1),localStorage.setItem("token",e?.data?.userinfo?.token??""),this.$notify.success({title:"提示",message:"登录成功",offset:this.$root.notifyOffet}),this.$refs?.login?.hide(),"/usercenter"!=this.$route.path&&this.$router.replace({path:"/usercenter"}),void this.$emit("hide",!0))})).catch((t=>{this.hideHcaptcha=!0,this.$nextTick((()=>{this.hideHcaptcha=!1})),this.$root.enableMask(!1),this.$root.loading(!1),this.$emit("hide",!0),this.$nextTick((()=>{this.$root.netError(t)}))}))):this.$notify.error({title:"提示",message:"请完成人机验证",offset:this.$root.notifyOffet})}}},H=U,O=(0,v.A)(H,R,N,!1,null,"e0779540",null),M=O.exports,z=function(){var t=this,e=t._self._c;return e("div",{attrs:{id:"appealBox"}},[e("dialogLib",{ref:"appeal",attrs:{title:"解封申诉",titleSize:"2rem",height:"auto"},on:{hide:function(e){return t.$emit("hide",!0)}}},[e("div",{staticClass:"form"},[e("div",{staticClass:"alerts"},[e("el-alert",{attrs:{title:"我们很抱歉的通知您,你的账号因违反平台规则而被封禁.",type:"error",closable:!1}}),e("el-alert",{attrs:{title:t.reason,type:"error",closable:!1}}),e("el-alert",{attrs:{title:"您可以尝试填写以下表单材料,提交申诉进行解封,但我们不保证您的申诉一定会通过.",type:"error",closable:!1}})],1),e("input",{directives:[{name:"model",rawName:"v-model",value:t.form.username,expression:"form.username"}],attrs:{type:"text",readonly:""!=t.form.username,placeholder:"请输入用户名/邮箱"},domProps:{value:t.form.username},on:{input:function(e){e.target.composing||t.$set(t.form,"username",e.target.value)}}}),e("textarea",{directives:[{name:"model",rawName:"v-model",value:t.form.content,expression:"form.content"}],staticClass:"contnet",attrs:{rows:"10"},domProps:{value:t.form.content},on:{input:function(e){e.target.composing||t.$set(t.form,"content",e.target.value)}}}),e("div",{staticClass:"alerts"},[t._v(" 完成人机验证以提交 ")]),t.hideHcaptcha?t._e():e("div",{staticClass:"code"},[e("vue-hcaptcha",{attrs:{sitekey:t.hCaptchaKey,size:t.hideHcaptcha?"invisible":"normal"},on:{verify:t.hcapResult}})],1)])])],1)},G=[],j={name:"appealBox",components:{VueHcaptcha:h(),dialogLib:T},props:{reason:{type:String,default:""},username:{type:String,default:""}},data(){return{form:{username:"",content:"",code:""},URL:window.config.apiUrl,hCaptchaKey:window.config.hCaptcha,hideHcaptcha:!1}},watch:{},methods:{hcapResult(t){this.form.code=t,t&&(this.hideHcaptcha=!0,this.submit())},submit(){if(""==this.form.username||""==this.form.content)return this.$notify.error({title:"提示",message:"请填写完整信息",offset:this.$root.notifyOffet}),this.$nextTick((()=>{this.hideHcaptcha=!1})),void(this.form={username:"",content:"",code:""});""!=this.form.code?(this.$root.loading(!0),u.A.post(this.URL+"/ticket/unban",this.form).then((t=>{let e=t.data??null;return-1==e.code?(this.$notify.error({title:"提示",message:e.msg,offset:this.$root.notifyOffet}),this.$root.loading(!1),this.$root.enableMask(!1),void(this.hideHcaptcha=!1)):-2==e.code?(this.$root.loading(!1),this.$root.enableMask(!1),this.hideHcaptcha=!1,void this.$emit("appeal",!0)):(this.$root.enableMask(!1),this.$root.loading(!1),this.$notify.success({title:"提示",message:"提交成功,请等待审核.",offset:this.$root.notifyOffet}),this.$refs?.appeal?.hide(),void this.$emit("hide",!0))})).catch((t=>{this.hideHcaptcha=!1,this.$root.enableMask(!1),this.$root.loading(!1),this.$emit("hide",!0),this.$nextTick((()=>{this.$root.netError(t)}))}))):this.$notify.error({title:"提示",message:"请完成人机验证",offset:this.$root.notifyOffet})}},created(){this.form.username=this.username}},q=j,K=(0,v.A)(q,z,G,!1,null,"3925975d",null),W=K.exports,X=function(){var t=this,e=t._self._c;return e("div",{attrs:{id:"menuBox"}},[e("div",{staticClass:"menuBox"},[e("div",{staticClass:"logo"},[e("img",{attrs:{src:t.logoPng}}),e("img",{staticClass:"text",attrs:{src:t.fontPng}})]),e("div",{staticClass:"userInfo"},[e("el-tooltip",{attrs:{effect:"dark",content:t.userInfo?.username?t.userInfo?.username:"未知用户",placement:"bottom"}},[e("div",{staticClass:"name"},[t._v(t._s(t.userInfo?.username?t.$root.shortStr(t.userInfo.username,5):"未知用户"))])]),e("el-tooltip",{staticClass:"exitButton",attrs:{effect:"dark",content:"退出",placement:"bottom"}},[e("div",{staticClass:"exit",on:{click:function(e){return t.$root.logout()}}})])],1)]),e("div",{staticClass:"bottomBox"},[e("ul",t._l(t.menus,(function(a){return e("li",{key:a.name,class:a.isActive?"active":"",on:{click:function(e){return t.linkTo(a)}}},[e("i",{class:"icon "+a.icon}),e("span",[t._v(t._s(a.name))])])})),0),e("div",{staticClass:"childContent",style:t.childStyle},[e("ul",t._l(t.childContent,(function(a){return e("li",{key:a.name,on:{click:function(e){return t.linkTo(a)}}},[e("div",{staticClass:"item"},[e("div",{staticClass:"name"},[e("i",{class:"icon "+a.icon}),e("span",[t._v(t._s(a.name))])])])])})),0)])])])},V=[],Y=(a(7550),a.p+"img/font.2f200432.png"),Z={name:"menuBox",props:{userInfo:{type:Object,default:function(){return null}}},data(){return{fontPng:Y,logoPng:l,childContent:[],childStyle:{},ceilNum:3,rowHeight:62,menus:[{name:"首页",url:"/usercenter",isParent:!1,icon:"el-icon-s-home",isActive:!1},{name:"服务",isParent:!0,icon:"el-icon-s-help",isActive:!1,child:[{name:"服务器状态",url:"/servers",icon:"el-icon-s-unfold",content:"在这里您可以查看所有服务器的状态与负载情况"},{name:"隧道列表",url:"/tunnel",icon:"el-icon-s-unfold",content:"在这里您可以添加、修改、删除、查看您所拥有的隧道列表"},{name:"软件下载",url:"/download",icon:"el-icon-download",content:"在这里您可以下载软件，并查看软件更新日志"},{name:"备案审核",url:"/domainauth",icon:"el-icon-s-claim",content:"在这里您可以对您的域名申请备案"},{name:"工单系统",url:"/ticket",icon:"el-icon-s-order",content:"在这里您可以向客服人员提交工单、查看或回复工单"}]},{name:"用户",url:"/user",icon:"el-icon-user-solid",isParent:!1,isActive:!1},{name:"商城",url:"/mall",icon:"el-icon-s-shop",isParent:!1,isActive:!1},{name:"帮助",url:"/help",icon:"el-icon-question",isParent:!1,isActive:!1}]}},watch:{$route:{handler(){this.menuActive(this.$route.path)},deep:!0,immediate:!0}},methods:{menuActive(t=""){0!==this.menus.length&&this.menus.forEach((e=>{e.isActive=!1,e.url!==t?e.child&&(e.isActive=e.child.some((e=>e.url===t))):e.isActive=!0}))},computeChildStyle(){let t=Math.ceil(this.childContent.length/this.ceilNum)*this.rowHeight;this.childStyle={height:t+50+"px"},setTimeout((()=>{this.childStyle={...this.childStyle,overflow:"auto"},console.log(this.childStyle)}),301)},linkTo(t){if(!t?.url||t?.isParent)return void this.openChildList(t);let e=t?.url;this.hideChildList(),this.$root.linkTo(e)},openChildList(t){t?.isParent&&(this.$root.enableMask(!0,"61px",6,this.hideChildList),this.childContent=t?.child??[],this.computeChildStyle())},hideChildList(){this.childStyle="",this.$root.enableMask(!1),setTimeout((()=>{this.childContent=[]}),301)}},mounted(){}},J=Z,Q=(0,v.A)(J,X,V,!1,null,"691a10aa",null),tt=Q.exports,et=function(){var t=this;t._self._c;return t._m(0)},at=[function(){var t=this,e=t._self._c;return e("div",{staticClass:"footer"},[e("div",{staticClass:"content"},[t._v(" 千鹤FRP版权所有 ")])])}],it={name:"footerBox"},st=it,ot=(0,v.A)(st,et,at,!1,null,"415018b6",null),lt=ot.exports,nt={name:"App",components:{regBox:E,loginBox:M,menuBox:tt,footerBox:lt,appealBox:W},data(){return{URL:window.config.apiUrl,isNetERR:!1,isShowLogin:!1,isShowReg:!1,isShowAppealBox:!1,logo:l,loadingIcon:n,scrollLock:!1,mask:!1,maskStyle:"",loading:!1,userInfo:null,maskTimer:[],banReason:"",banUsername:"",clickMask:function(){}}},watch:{loading:{handler(t){if(t)this.mask=!0,this.scrollLock=!0;else if(!this.loading&&!this.isShowLogin&&!this.isShowReg&&!this.isShowAppealBox){let t=null!=document.querySelector(".dialog");t||(this.mask=!1),this.scrollLock=!1}},immediate:!0},isShowLogin:function(t){t||this.isShowReg?(this.mask=!0,this.$root.scrollLock=!0):this.loading||t||this.isShowReg||(this.mask=!1,this.$root.scrollLock=!1)},isShowReg:function(t){t||this.isShowLogin?(this.mask=!0,this.$root.scrollLock=!0):this.loading||t||this.isShowLogin||(this.mask=!1,this.$root.scrollLock=!1)},isShowAppealBox:function(t){t||this.isShowReg?(this.mask=!0,this.$root.scrollLock=!0):this.loading||t||this.isShowReg||(this.mask=!1,this.$root.scrollLock=!1)},isNetERR:function(t){t?(this.mask=!0,this.$root.scrollLock=!0):(this.mask=!1,this.$root.scrollLock=!1)},"$route.path":function(t){"/"!=t&&this.LocalGetUserInfo()}},methods:{refresh(){window.location.reload()},netError(t=null){let e=t?.status??null;e&&401==e||(console.log(t),this.isNetERR=!0,this.enableMask(!0))},goLogin(){this.isShowReg=!1,this.isShowLogin=!0},goReg(){this.isShowLogin=!1,this.isShowReg=!0},enableMask(t=!0,e=0,a="8",i=null){null!=i&&(this.clickMask=function(t=this){i(),t.clickMask=function(){}});try{let i=5;t&&(document.documentElement.style.overflow="hidden",this.maskStyle="top:"+e+";z-index:"+a+";",this.mask=!0),t||(document.documentElement.style.overflow="auto",this.$refs.mask.classList.remove("active"),i=300);let s=setTimeout((()=>{t?this.$refs.mask.classList.add("active"):(this.mask=!1,this.maskStyle="");for(let t=0;t<this.maskTimer.length;t++)clearTimeout(this.maskTimer[t])}),i);this.maskTimer.push(s)}catch(s){console.log("遮罩可能已关闭")}},async getUserInfo(){let t=localStorage.getItem("token")??null;if(!t)return null;let e={headers:{token:t}},a=null;try{a=await u.A.get(this.URL+"/user/index",e)}catch(i){return this.netError(i),null}return a.data??null},async logout(){localStorage.removeItem("token"),window.location.reload()},async checkLogin(){let t=await this.getUserInfo();return!(!localStorage.getItem("token")||!t)&&t},loadingEvent(t=!0){this.loading=t},getLocalToken(){let t=localStorage.getItem("token")??null;return t||("/"!=this.$route.path&&this.$router.replace("/"),this.$root.goLogin(),null)},formatterDomains(t){let e=JSON.parse(t);return e},linkTo(t,e="_self"){this.$route.path!=t&&"_self"==e&&this.$router.replace(t),"_blank"==e&&window.open(t)},getDate(t){let e=new Date(1e3*t),a=e.getFullYear(),i=e.getMonth()+1,s=e.getDate(),o=e.getHours(),l=e.getMinutes(),n=e.getSeconds();return i=i<10?"0"+i:i,s=s<10?"0"+s:s,o=o<10?"0"+o:o,l=l<10?"0"+l:l,n=n<10?"0"+n:n,a+"-"+i+"-"+s+" "+o+":"+l+":"+n},shortStr(t,e=10){return t.length<=e?t:t.substring(0,e)+"..."},checkMob(){let t=navigator.userAgent||navigator.vendor||window.opera;return/Android|iPhone|iPad|iPod|Windows Phone|webOS|BlackBerry|IEMobile|Opera Mini|Mobi/i.test(t)},setScollLock(t=!0){this.scrollLock=t},async LocalGetUserInfo(){let t=await this.checkLogin();t||"/"!=this.$route.path&&(this.$router.replace("/"),this.goLogin()),this.userInfo=t?.data??null},closeLogin(){this.isShowLogin=!1},openAppeal(t="",e=""){console.log(t,e),this.banReason=t,this.banUsername=e,this.isShowAppealBox=!0,this.closeLogin()},closeAppeal(){this.isShowAppealBox=!1}},created(){this.checkMob()||!window.config.pcPage||window.config.DEBUG||(window.location.href=window.config.pcPage),this.LocalGetUserInfo()},mounted(){let t=["雁影翻飞，云起千鹤","风拂羽翼，逐光而行","水流轻漾，映鹤初醒","山色入画，千鹤待启","霞光映羽，天地共舞","晨露微光，鹤影悠然","夜月沉沉，羽影婆娑","松间清响，鹤鸣远山","梧桐细雨，羽声点点","青山隐隐，千鹤归巢","风摇竹影，羽舞悠扬","流云轻荡，鹤行天地","水光潋滟，羽影翩翩","晨曦微露，千鹤初醒","霜叶飘零，羽舞轻扬","云间鹤影，逐风而行","竹林深处，鹤鸣悠远","暮色渐染，千鹤归途"],e=document.getElementById("siteloading");if(!e)return;let a=e.querySelector(".text");if(!a)return;let i=0;a.innerHTML=t[i],a.classList.remove("hide");let s=setInterval((()=>{a.classList.add("hide"),setTimeout((()=>{i=(i+1)%t.length,a.innerHTML=t[i],a.classList.remove("hide")}),800)}),5e3);window.onload=()=>{clearInterval(s),e.classList.add("hide"),setTimeout((()=>{e.remove()}),300),console.log("所有资源已加载完毕")},this.$root.notifyOffet=61,this.$root.scrollLock=this.scrollLock,this.$root.setScollLock=this.setScollLock,this.$root.netError=this.netError,this.$root.goLogin=this.goLogin,this.$root.goReg=this.goReg,this.$root.enableMask=this.enableMask,this.$root.logout=this.logout,this.$root.checkLogin=this.checkLogin,this.$root.loading=this.loadingEvent,this.$root.getLocalToken=this.getLocalToken,this.$root.formatterDomains=this.formatterDomains,this.$root.linkTo=this.linkTo,this.$root.getDate=this.getDate,this.$root.shortStr=this.shortStr,this.$root.checkMob=this.checkMob}},rt=nt,ct=(0,v.A)(rt,s,o,!1,null,null,null),dt=ct.exports,ht=a(9143),ut=a.n(ht),mt=a(2467);i["default"].use(ut(),{locale:mt["default"]});var gt=a(6178),pt=function(){var t=this,e=t._self._c;return e("div",{attrs:{id:"homePage"}},[e("div",{staticClass:"logo"},[e("img",{attrs:{src:t.logo}}),e("span",[t._v("千鹤FRP")]),e("span",{staticClass:"copyright"},[t._v("千鹤FRP版权所有")])]),e("div",{staticClass:"backgroundBanner",attrs:{id:"backgroundBanner"}},[e("div",{staticClass:"backGround h1BackGround",style:"opacity:"+t.h1Opacity}),e("div",{staticClass:"backGround h2BackGround",style:"opacity:"+t.h2Opacity}),e("div",{staticClass:"backGround h3BackGround",style:"opacity:"+t.h3Opacity}),e("div",{staticClass:"backGround h4BackGround",style:"opacity:"+t.h4Opacity}),e("div",{staticClass:"mainContent h1Content",attrs:{id:"h1Content"}},[e("img",{staticClass:"title",attrs:{src:t.font}}),e("div",{staticClass:"btnGroup"},[e("div",{staticClass:"btn",on:{click:function(e){return t.goManage()}}},[e("div",{staticClass:"text"},[t._v("管理面板")])]),e("div",{staticClass:"btn",on:{click:function(e){return t.$root.goReg()}}},[e("div",{staticClass:"text"},[t._v("注册账号")])])])]),e("div",{staticClass:"mainContent h2Content",attrs:{id:"h2Content"}},[e("div",{staticClass:"title"},[t._v("介绍")]),e("div",{staticClass:"textBox",on:{touchmove:function(e){t.$root.scrollLock=!0},touchend:function(e){t.$root.scrollLock=!1}}},[e("div",{staticClass:"text",domProps:{innerHTML:t._s(t.h2Data.content??"")}})])]),e("div",{staticClass:"mainContent h3Content",attrs:{id:"h3Content"}},[e("div",{staticClass:"title"},[e("div",{staticClass:"text"},[t._v("定价")]),e("div",{staticClass:"more",on:{click:function(e){return t.goMall()}}},[t._v("更多套餐")])]),e("div",{staticClass:"prices"},t._l(t.priceData,(function(a,i){return e("div",{key:i,staticClass:"item"},[e("div",{staticClass:"name"},[t._v(t._s(a.name))]),e("div",{staticClass:"itemContent",domProps:{innerHTML:t._s(a.content)}}),e("div",{staticClass:"bottom"},[e("div",{staticClass:"price"},[t._v("价格:"),e("span",{staticClass:"num"},[t._v(t._s(a.price))]),t._v("/月")]),e("div",{staticClass:"btn",on:{click:function(e){return t.goMall()}}},[t._v(" 前去购买 ")])])])})),0)]),e("div",{staticClass:"mainContent h4Content",attrs:{id:"h4Content"}},[e("div",{staticClass:"title"},[t._v("团队")]),e("div",{staticClass:"teamBox",on:{touchmove:function(e){t.$root.scrollLock=!0},touchend:function(e){t.$root.scrollLock=!1}}},t._l(t.h4Data,(function(a,i){return e("div",{key:"team_"+i,staticClass:"person igron"},[e("div",{staticClass:"name igron"},[e("img",{attrs:{src:a.img}}),t._v(" "+t._s(a.name)+" ")]),e("div",{staticClass:"job igron"},[t._v(" 职责:"+t._s(a.job)+" ")]),e("div",{staticClass:"intro igron",domProps:{innerHTML:t._s(a.content)}})])})),0)])])])},ft=[],vt={name:"HomePage",components:{},data(){return{font:Y,logo:l,URL:window.config.apiUrl,priceData:[],h2Data:[],h4Data:[],pageList:["h1","h2","h3","h4"],currentPage:"h1",h1Opacity:1,h2Opacity:0,h3Opacity:0,h4Opacity:0,scrollListenerObject:null}},watch:{},methods:{scrollListener(){let t=document.querySelector("#backgroundBanner");if(!t)return;let e=t.addEventListener("scroll",(()=>{let e=t.scrollTop,a=t.clientHeight,i=e/a;this.h1Opacity=1-i,this.h2Opacity=i,this.h3Opacity=i-1,this.h4Opacity=i-2}),{passive:!1});this.scrollListenerObject=e},getPrice(t=1,e=3){u.A.get(this.URL+"content/package?page="+t+"&limit="+e).then((t=>{this.priceData=t.data.data.data??[]})).catch((t=>{this.$root.netError(t)}))},getData(){u.A.get(this.URL+"content/front").then((t=>{let e=t.data.data??[];this.h2Data=e.intro[0]??[],this.h4Data=e.team??[]})).catch((t=>{this.$root.netError(t)}))},async goMall(){let t=await this.$root.checkLogin();t?"/mall"!=this.$route.path&&this.$router.replace("/mall"):this.$root.goLogin()},async goManage(){let t=await this.$root.checkLogin();t?"/usercenter"!=this.$route.path&&this.$router.replace("/usercenter"):this.$root.goLogin()}},beforeCreate(){},created(){this.getPrice(),this.getData()},mounted(){this.$nextTick((()=>{this.scrollListener()}))},destroyed(){let t=document.querySelector("#backgroundBanner");t&&t.removeEventListener("scroll",this.scrollListenerObject)}},Ct=vt,bt=(0,v.A)(Ct,pt,ft,!1,null,"bd75654e",null),wt=bt.exports,_t=function(){var t=this,e=t._self._c;return e("div",{staticClass:"page",attrs:{id:"userCenterPage"}},[e("div",{staticClass:"mainContent"},[e("el-tabs",{model:{value:t.activeName,callback:function(e){t.activeName=e},expression:"activeName"}},[e("el-tab-pane",{attrs:{label:"用户信息",name:"userdata"}},[e("userData",{attrs:{userInfo:t.userInfo}})],1),e("el-tab-pane",{attrs:{label:"每日签到",name:"signin"}},[e("signIn",{attrs:{userInfo:t.userInfo},on:{finish:t.getUserInfo}})],1),e("el-tab-pane",{attrs:{label:"流量统计",name:"trafficchart"}},[e("chartBox",{ref:"chartBox",attrs:{name:"trafficChart",title:"流量统计"}})],1),e("el-tab-pane",{attrs:{label:"公告列表",name:"announces"}},[e("announceList",{attrs:{showMore:!0}})],1)],1)],1)])},yt=[],kt=function(){var t=this,e=t._self._c;return e("div",{staticClass:"card",attrs:{id:"userData"}},[e("div",{staticClass:"cardTitle"},[t._v("账号信息")]),e("div",{class:t.loading?"data loadingLocal":"data"},[e("div",{staticClass:"item"},[e("label",[t._v("用户名")]),e("div",{staticClass:"value"},[t._v(t._s(t.userInfo?.username??"未知用户"))])]),e("div",{staticClass:"item"},[e("label",[t._v("用户组")]),e("div",{staticClass:"value"},[t._v(t._s(t.userInfo?.group_info?.name??"未知用户组"))])]),e("div",{staticClass:"item"},[e("label",[t._v("带宽限制")]),e("div",{staticClass:"value"},[t._v(t._s(t.userInfo?.frp_bandwidth??"未知"))])]),e("div",{staticClass:"item"},[e("label",[t._v("基准隧道")]),e("div",{staticClass:"value"},[t._v(t._s(t.userInfo?.frp_tunnel_count??"0"))])]),e("div",{staticClass:"item"},[e("label",[t._v("扩展隧道")]),e("div",{staticClass:"value"},[t._v(t._s(t.userInfo?.extend_tunnel_count??"0"))])]),e("div",{staticClass:"item"},[e("label",[t._v("剩余隧道")]),e("div",{staticClass:"value"},[t._v(t._s(t.userInfo?.remaining_tunnel_count??"0"))])]),e("div",{staticClass:"item"},[e("label",[t._v("基准流量")]),e("div",{staticClass:"value"},[t._v(t._s(t.trafficAmount(t.userInfo?.frp_traffic_amount??null)))])]),e("div",{staticClass:"item"},[e("label",[t._v("扩展流量")]),e("div",{staticClass:"value"},[t._v(t._s(t.trafficAmount(t.userInfo?.extend_traffic_amount??null)))])]),e("div",{staticClass:"item"},[e("label",[t._v("剩余流量")]),e("div",{staticClass:"value"},[t._v(t._s(t.trafficAmount(t.userInfo?.remaining_traffic_amount??null)))])])])])},xt=[],$t={name:"userData",props:{userInfo:{type:Object,default:function(){return null}}},watch:{userInfo:function(){this.loading=!1}},data:function(){return{loading:!1}},methods:{trafficAmount(t){return t?(t/1024).toFixed(2)+"MB":"0MB"}},mounted(){this.loading=!0}},Lt=$t,St=(0,v.A)(Lt,kt,xt,!1,null,"1878c6c9",null),Dt=St.exports,Ft=function(){var t=this,e=t._self._c;return e("div",{class:t.loading?"card loadingLocal":"card",attrs:{id:"signin"}},[e("div",{staticClass:"cardTitle"},[t._v("每日签到")]),e("div",{staticClass:"content"},[t._v("立即签到获取每日流量奖励!")]),t.isToday?e("div",{staticClass:"already"},[e("div",{staticClass:"right"}),e("div",{staticClass:"text"},[t._v("今日已签到")])]):t._e(),t.isToday?t._e():e("div",{staticClass:"btn",on:{click:t.signin}},[e("div",{staticClass:"text"},[t._v("签到处")]),e("div",{staticClass:"fingerPrint"})])])},At=[],Tt={name:"signIn",props:{userInfo:{type:Object,default:function(){return null}}},watch:{userInfo:function(){this.loading=!1}},data(){return{URL:window.config.apiUrl,loading:!1,axiosC:new AbortController}},computed:{isToday(){let t=this.userInfo?.sign_time??null;if(null==t)return!1;let e=new Date(1e3*t);return e.getFullYear()==(new Date).getFullYear()&&e.getMonth()==(new Date).getMonth()&&e.getDate()==(new Date).getDate()}},methods:{async signin(){this.$root.loading(!0);let t=this.$root.getLocalToken();if(!t)return;let e={headers:{token:t},signal:this.axiosC.signal},a=null;try{a=await u.A.post(this.URL+"user/sign",{},e)}catch(i){return void(u.A.isCancel&&u.A.isCancel(i)||"CanceledError"===i.name?console.log("用户取消请求"):(this.$root.loading(!1),this.$root.netError(i)))}-1!=a?.data.code?(this.$emit("finish"),this.$root.loading(!1),this.$notify.success({title:"提示",message:a?.data.msg??"签到成功",offset:this.$root.notifyOffet})):this.$notify.error({title:"提示",message:a?.data.msg??"未知错误",offset:this.$root.notifyOffet})}},mounted(){this.loading=!0},beforeDestroy(){this.axiosC.abort()}},Pt=Tt,It=(0,v.A)(Pt,Ft,At,!1,null,"488e5b6e",null),Bt=It.exports,Et=function(){var t=this,e=t._self._c;return e("div",{staticClass:"card",attrs:{id:"announceList"}},[e("div",{staticClass:"cardTitle"},[t._v("公告列表")]),e("div",{class:t.loading?"content loadingLocal":"content"},[e("ul",[t._l(t.normalData?.data,(function(a,i){return e("li",{key:"announce_"+i,staticClass:"item",on:{click:function(e){return t.showDetail(a)}}},[e("i",{staticClass:"icon el-icon-info"}),t._v(t._s(a.title)+" ")])})),t.showMore&&t.normalData?.data?.length>0?e("li",{staticClass:"item more",on:{click:t.more}},[t._v("查看更多"),e("i",{staticClass:"icon el-icon-more"})]):t._e()],2)]),t.isShowMore?e("dialogLib",{attrs:{title:"全部公告",top:"80px"},on:{hide:t.closeMore}},[e("div",{class:t.allAnnounceLoading?"content loadingLocal":"content"},[e("ul",t._l(t.data?.data,(function(a,i){return e("li",{key:"announce_"+i,staticClass:"item",on:{click:function(e){return t.showDetail(a)}}},[e("i",{staticClass:"icon el-icon-info"}),t._v(t._s(a.title)+" ")])})),0),t.data?.data?.length>0?e("div",{staticClass:"pagenation"},[e("pageLib",{attrs:{total:t.data?.last_page,page:t.data?.current_page,limit:10},on:{change:t.changePage}})],1):t._e()])]):t._e(),""!=t.title?e("dialogLib",{attrs:{title:"公告详情-"+t.title,top:"80px",hideWithMask:!t.isShowMore},on:{hide:t.close}},[e("div",{staticClass:"detail",domProps:{innerHTML:t._s(t.content)}})]):t._e()],1)},Rt=[],Nt=function(){var t=this,e=t._self._c;return e("div",{staticClass:"pageLib"},[e("i",{class:"icon el-icon-caret-left"+(t.selected>1?"":" disabled"),on:{click:t.prePage}}),t.data?.length>0?e("ul",[t._v(" 第 "),t._l(t.data,(function(a){return e("li",{key:"page_"+a,on:{click:function(e){return t.select(a)}}},[e("div",{class:t.selected==a?"num active":"num"},[t._v(t._s(a))])])})),t._v(" 页 ")],2):e("ul",[t._v(" 第0页 ")]),e("i",{class:"icon el-icon-caret-right"+(t.selected<t.total?"":" disabled"),on:{click:t.nextPage}})])},Ut=[],Ht={name:"pageLib",props:{total:{type:Number,default:20},limit:{type:Number,default:10},page:{type:Number,default:1}},data(){return{selected:this.page,data:[]}},watch:{total(){this.formatterData()},selected(t){this.$emit("change",t)},page(){this.selected=this.page}},methods:{formatterData(){this.data=[];const{total:t,limit:e,selected:a}=this;if(t<=e){for(let e=1;e<=t;e++)this.data.push(e);return}const i=[];i.push(1);let s=a-Math.floor((e-3)/2),o=a+Math.floor((e-3)/2);s<=2&&(s=2,o=e-2),o>=t-1&&(o=t-1,s=t-(e-3)),s>2&&i.push("...");for(let l=s;l<=o;l++)i.push(l);o<t-1&&i.push("..."),i.push(t),this.data=i},select(t){"..."!==t&&this.selected!==t&&(this.selected=t,this.formatterData())},prePage(){this.selected>1&&(this.selected--,this.formatterData())},nextPage(){this.selected<this.total&&(this.selected++,this.formatterData())}},mounted(){this.formatterData()}},Ot=Ht,Mt=(0,v.A)(Ot,Nt,Ut,!1,null,"087442ee",null),zt=Mt.exports,Gt={name:"announceList",components:{pageLib:zt,dialogLib:T},props:{showMore:{type:Boolean,default:!0}},data(){return{URL:window.config.apiUrl,data:[],normalData:[],content:"",title:"",isShowMore:!1,limit:10,moreLimit:20,loading:!1,allAnnounceLoading:!1,axiosC:new AbortController}},methods:{async changePage(t){this.allAnnounceLoading=!0,this.data=[],await this.getAnnounce(t,this.moreLimit),this.allAnnounceLoading=!1},async getAnnounce(t=1,e=10){let a=null,i=this.$root.getLocalToken();if(i){try{a=await u.A.get(this.URL+"content/announce?page="+t+"&limit="+e,{headers:{token:i},signal:this.axiosC.signal})}catch(s){return void(u.A.isCancel&&u.A.isCancel(s)||"CanceledError"===s.name?console.log("用户取消请求"):(this.loading=!1,this.$root.netError(s)))}this.loading=!1,-1!=a?.data?.code?(0==this.normalData.length&&(this.normalData=a?.data?.data),this.data=a?.data?.data):this.$notify.error({title:"提示",message:a.msg,offset:this.$root.notifyOffet})}},showDetail(t){this.title=t.title,this.content=t.content},close(){this.content="",this.title=""},async more(){this.data=[],this.allAnnounceLoading=!0,this.isShowMore=!0,await this.getAnnounce(1,this.moreLimit),this.allAnnounceLoading=!1},closeMore(){this.isShowMore=!1,""==this.content&&this.title}},mounted(){this.$nextTick((()=>{this.loading=!0,this.getAnnounce(1,this.limit)}))},beforeDestroy(){this.axiosC.abort()}},jt=Gt,qt=(0,v.A)(jt,Et,Rt,!1,null,"f4a44074",null),Kt=qt.exports,Wt=function(){var t=this,e=t._self._c;return e("div",{staticClass:"card"},[e("div",{staticClass:"cardTitle"},[e("div",[t._v(t._s(t.title))]),e("div",{staticClass:"btnGroup"},[e("buttonLib",{staticClass:"btn",attrs:{isActive:7==t.N,text:"7日"},on:{click:function(e){return t.getData(7)}}}),e("buttonLib",{staticClass:"btn",attrs:{isActive:30==t.N,text:"30日"},on:{click:function(e){return t.getData(30)}}}),e("buttonLib",{staticClass:"btn",attrs:{text:"刷新"},on:{click:function(e){return t.getData(t.N)}}})],1)]),e("div",{class:0==t.data?.x?.length?"chartBox loadingLocal":"chartBox",attrs:{id:t.name}})])},Xt=[],Vt=a(8497),Yt={name:"chartBox",components:{buttonLib:b},props:{name:{type:String,default:function(){return"chartBox"}},title:{type:String,default:function(){return"图表"}}},data(){return{URL:window.config.apiUrl,data:{x:[],y:[]},N:30,axiosC:new AbortController}},methods:{async getData(t=30){this.N=t;let e=this.$root.getLocalToken();if(this.data={x:[],y:[]},e){try{let a=await u.A.get(this.URL+"/frp/traffic?n="+t,{headers:{token:e},signal:this.axiosC.signal});if(1==a?.data?.code){let t=a.data.data;t.forEach((t=>{this.data.x.push(t.date),this.data.y.push(t.total)}))}}catch(a){u.A.isCancel&&u.A.isCancel(a)||"CanceledError"===a.name?console.log("用户取消请求"):this.$root.netError(a)}try{this.createChart()}catch(a){console.log("未找到图表元素-用户可能切换了页面:"),console.log(a)}}},createChart(){let t=document.getElementById(this.name);if(!t.offsetWidth||!t.offsetHeight)return;let e=Vt.FP(t);if(e||(e=Vt.Ts(t)),!e)return;let a,i=e,s=this.data?.x??[],o=this.data?.y??[],l=500,n=[];for(let r=0;r<o.length;r++)n.push(l);a={grid:{top:40,bottom:80,left:0,right:0},xAxis:{data:s,axisTick:{show:!1},axisLine:{show:!1},z:10},yAxis:{axisLine:{show:!1},axisTick:{show:!1},axisLabel:{color:"#999",formatter:function(t){return(t/1024).toFixed(0)+" MB"}}},dataZoom:[{type:"inside",start:this.N>=30?90:0,end:100,zoomLock:!0},{type:"slider",start:this.N>=30?90:0,end:100,minSpan:this.N>=30?17:0,maxSpan:this.N>=30?17:0,zoomLock:!0,backgroundColor:"#FFF",dataBackground:{lineStyle:{color:"#b81010",width:1},areaStyle:{color:"#FFF"}},selectedDataBackground:{lineStyle:{color:"#000",width:2},areaStyle:{color:"#FFF"}},fillerColor:"rgba(0,0,0,0.5)",handleSize:"0%",brushSelect:!1,moveHandleStyle:{color:"#000"}}],series:[{type:"bar",showBackground:!0,itemStyle:{color:new Vt.fA.W4(0,0,0,1,[{offset:0,color:"#999"},{offset:.5,color:"rgba(0,0,0,0.5)"},{offset:1,color:"#000"}])},emphasis:{itemStyle:{color:new Vt.fA.W4(0,0,0,1,[{offset:0,color:"#000"},{offset:.7,color:"rgba(0,0,0,0.5)"},{offset:1,color:"#999"}])}},label:{show:!0,color:"#FFF",fontSize:12,formatter:function(t){let e=t?.data/1024;return t.name+"   "+e.toFixed(2)+" MB"},rotate:90},data:o}]},a&&i.setOption(a)}},mounted(){this.$nextTick((()=>{this.getData(this.N)}))},beforeDestroy(){this.axiosC.abort()}},Zt=Yt,Jt=(0,v.A)(Zt,Wt,Xt,!1,null,"39c1e477",null),Qt=Jt.exports,te={name:"userCenterPage",components:{userData:Dt,signIn:Bt,announceList:Kt,chartBox:Qt},data(){return{activeName:"userdata",userInfo:null}},watch:{activeName:function(t){"trafficchart"==t&&this.$nextTick((()=>{this.$refs?.chartBox?.createChart()}))}},methods:{async getUserInfo(){let t=await this.$root.checkLogin();t||("/"!=this.$route.path&&this.$router.replace("/"),this.$root.goLogin()),this.userInfo=t?.data??null}},created(){},mounted(){this.$nextTick((()=>{this.getUserInfo()}))}},ee=te,ae=(0,v.A)(ee,_t,yt,!1,null,"b5fdbbe2",null),ie=ae.exports,se=function(){var t=this,e=t._self._c;return e("div",{staticClass:"page",attrs:{id:"tunnelPage"}},[e("div",{staticClass:"card"},[e("div",{staticClass:"cardTitle"},[t._v("隧道列表")]),e("div",{staticClass:"toolsBar"},[t._m(0),e("div",{staticClass:"row"},[e("el-select",{attrs:{multiple:"","collapse-tags":"",placeholder:"请选择协议"},model:{value:t.protocolFilter,callback:function(e){t.protocolFilter=e},expression:"protocolFilter"}},t._l(t.protocols,(function(t){return e("el-option",{key:t.value,attrs:{label:t.label,value:t.value}})})),1),e("input",{directives:[{name:"model",rawName:"v-model",value:t.nameFilter,expression:"nameFilter"}],attrs:{type:"text",placeholder:"请输入隧道名称"},domProps:{value:t.nameFilter},on:{input:function(e){e.target.composing||(t.nameFilter=e.target.value)}}})],1),e("div",{staticClass:"row"},[e("input",{directives:[{name:"model",rawName:"v-model",value:t.localAddrFilter,expression:"localAddrFilter"}],attrs:{type:"text",placeholder:"请输入本地地址"},domProps:{value:t.localAddrFilter},on:{input:function(e){e.target.composing||(t.localAddrFilter=e.target.value)}}}),e("input",{directives:[{name:"model",rawName:"v-model",value:t.remoteAddrFilter,expression:"remoteAddrFilter"}],attrs:{type:"number",placeholder:"请输入本地端口"},domProps:{value:t.remoteAddrFilter},on:{input:function(e){e.target.composing||(t.remoteAddrFilter=e.target.value)}}})]),e("div",{staticClass:"row"},[e("div",{staticClass:"btnGroup"},[e("buttonLib",{attrs:{btnClass:"btn",text:"新建隧道",disabled:0==t.userInfo?.remaining_tunnel_count},on:{click:function(e){return t.openServerSelect()}}}),e("buttonLib",{attrs:{btnClass:"btn",text:"刷新"},on:{click:function(e){return t.getData(t.limit,1)}}})],1)]),e("div",{staticClass:"row"},[t.userInfo?.remaining_tunnel_count>0?e("el-alert",{attrs:{title:"您还可以新建"+t.userInfo?.remaining_tunnel_count+"条隧道",type:"warning",effect:"dark",closable:!1}}):t._e(),0==t.userInfo?.remaining_tunnel_count?e("el-alert",{attrs:{title:"您已达到隧道数量限制 无法再新建任何隧道了",type:"error",effect:"dark",closable:!1}}):t._e()],1),e("div",{staticClass:"row"},[e("el-alert",{attrs:{title:"当您删除隧道后 域名占用不会马上同步 请耐心等待5-10分钟后再尝试使用相同的域名",type:"warning",effect:"dark",closable:!1}})],1)]),e("div",{class:t.loading?"tableBox loadingLocal":"tableBox"},[0===t.tableData.length?e("div",{staticClass:"empty"}):t._e(),t._l(t.tableData,(function(a,i){return e("div",{key:"tableData_"+i,staticClass:"tableLine"},[e("el-table",{staticStyle:{width:"100%"},attrs:{data:[a],border:"","show-header":!1,"row-class-name":"tableTitle"}},[e("el-table-column",{attrs:{"class-name":"no-bottom-border no-right-border",prop:"name",resizable:!1}}),e("el-table-column",{attrs:{"class-name":"no-bottom-border",label:"操作",resizable:!1},scopedSlots:t._u([{key:"default",fn:function(a){return[e("div",{staticClass:"btnGroup"},[e("buttonLib",{attrs:{btnClass:"rowBtn",size:"small",text:"编辑"},on:{click:function(e){return t.edit(a.row)}}}),e("buttonLib",{attrs:{btnClass:"rowBtn",size:"small",text:"normal"==a.row.status?"停用":"启用"},on:{click:function(e){return t.disable(a.row)}}}),e("buttonLib",{attrs:{btnClass:"rowBtn",size:"small",text:"删除"},on:{click:function(e){return t.delConfirm(a.row)}}})],1)]}}],null,!0)})],1),e("el-table",{staticStyle:{width:"100%"},attrs:{data:[a],border:"",size:"mini"}},[e("el-table-column",{attrs:{prop:"status",label:"状态",resizable:!1},scopedSlots:t._u([{key:"default",fn:function(a){return["normal"===a.row.status?e("el-tag",{attrs:{type:"success"}},[t._v("已启用")]):e("el-tag",{attrs:{type:"info"}},[t._v("已停用")])]}}],null,!0)}),e("el-table-column",{attrs:{prop:"protocol",label:"协议"}}),e("el-table-column",{attrs:{prop:"local_port",label:"本地端口",resizable:!1}})],1)],1)})),e("div",{staticClass:"pagenation"},[e("pageLib",{attrs:{total:t.totalPage,page:t.page},on:{change:t.changePage}})],1)],2)]),t.isShowServerSelectBox?e("dialogLib",{attrs:{title:"选择服务器",width:"calc(100vw - 20px);",height:"calc(100vh - 40px);",maxHeight:"calc(100vh - 40px);"},on:{hide:t.closeServerSelectBox}},[e("div",{staticClass:"serverList"},[e("div",{staticClass:"toolsBar"},[e("div",{staticClass:"row"},[e("div",{staticClass:"title"},[t._v("搜索")])]),e("div",{staticClass:"row"},[e("input",{directives:[{name:"model",rawName:"v-model",value:t.newNameFilter,expression:"newNameFilter"}],attrs:{placeholder:"请输入服务器名称"},domProps:{value:t.newNameFilter},on:{input:function(e){e.target.composing||(t.newNameFilter=e.target.value)}}}),e("el-select",{attrs:{multiple:"","collapse-tags":"",placeholder:"请选择协议"},model:{value:t.newProtocolFilter,callback:function(e){t.newProtocolFilter=e},expression:"newProtocolFilter"}},t._l(t.protocols,(function(t){return e("el-option",{key:t.value,attrs:{label:t.label,value:t.value}})})),1)],1),e("div",{staticClass:"row"},[e("el-select",{attrs:{"collapse-tags":"",placeholder:"请选择用户组"},model:{value:t.newUserGroupFilter,callback:function(e){t.newUserGroupFilter=e},expression:"newUserGroupFilter"}},[e("el-option",{attrs:{label:"全部",value:"all"}}),t._l(t.userGroups,(function(t){return e("el-option",{key:t.value,attrs:{label:t.label,value:t.value}})}))],2)],1)]),e("div",{staticClass:"serverData"},t._l(t.serverList,(function(a){return e("div",{key:"server_"+a.id,staticClass:"item",on:{click:function(e){return t.newTunnel(a)}}},[e("div",{staticClass:"name"},[t._v(t._s(a.name))]),e("div",{staticClass:"group"},t._l(a.group_arr,(function(i){return e("el-tag",{key:"group_"+a.id+"_"+i,attrs:{type:"info"}},[t._v(t._s(i))])})),1),e("div",{staticClass:"protocals"},t._l(a.protocol,(function(i){return e("el-tag",{key:"protocol_"+a.id+"_"+i,attrs:{type:"info"}},[t._v(t._s(i))])})),1),e("div",{staticClass:"runtime"},[e("span",{staticClass:"label"},[t._v("连续运行:")]),t._v(t._s(a.payload_time)+" ")]),e("div",{staticClass:"payload"},[e("span",{staticClass:"label"},[t._v("当前负载:")]),t._v(t._s(a.payload_load_5)+"% ")]),a.payload_json.total_ports>0?e("div",{staticClass:"portused"},[e("span",{staticClass:"label"},[t._v("已用端口:")]),t._v(t._s(a.payload_json.used_ports)+"/"+t._s(a.payload_json.total_ports)+" ")]):t._e(),0==a.payload_json.total_ports?e("div",{staticClass:"portused"},[e("span",{staticClass:"label"},[t._v("已用端口:")]),t._v(t._s(a.payload_json.used_ports)+"/无限 ")]):t._e()])})),0)])]):t._e(),t.editId?e("dialogLib",{attrs:{title:"隧道编辑",width:"calc(100vw - 20px);",height:"calc(100vh - 40px);",maxHeight:"calc(100vh - 40px);"},on:{hide:t.closeEdit}},[e("div",{staticClass:"editFrom"},[e("div",{staticClass:"row"},[e("div",{staticClass:"title"},[t._v("状态")]),e("div",{staticClass:"btnGroup"},[e("buttonLib",{attrs:{btnClass:"btn",size:"small",isActive:"normal"==t.editData?.status,text:"启用"},on:{click:function(e){t.editData.status="normal"}}}),e("buttonLib",{attrs:{btnClass:"btn",size:"small",isActive:"hidden"==t.editData?.status,text:"停用"},on:{click:function(e){t.editData.status="hidden"}}})],1)]),e("div",{staticClass:"row"},[e("div",{staticClass:"title"},[t._v("隧道名称")]),e("input",{directives:[{name:"model",rawName:"v-model",value:t.editData.name,expression:"editData.name"}],attrs:{placeholder:"请输入隧道名称"},domProps:{value:t.editData.name},on:{input:function(e){e.target.composing||t.$set(t.editData,"name",e.target.value)}}})]),e("div",{staticClass:"row"},[e("div",{staticClass:"title"},[t._v("本地IP")]),e("input",{directives:[{name:"model",rawName:"v-model",value:t.editData.local_addr,expression:"editData.local_addr"}],attrs:{placeholder:"请输入本地IP"},domProps:{value:t.editData.local_addr},on:{input:function(e){e.target.composing||t.$set(t.editData,"local_addr",e.target.value)}}})]),e("div",{staticClass:"row"},[e("div",{staticClass:"title"},[t._v("本地端口")]),e("input",{directives:[{name:"model",rawName:"v-model",value:t.editData.local_port,expression:"editData.local_port"}],attrs:{placeholder:"请输入本地端口"},domProps:{value:t.editData.local_port},on:{input:function(e){e.target.composing||t.$set(t.editData,"local_port",e.target.value)}}})]),e("div",{staticClass:"row"},[e("div",{staticClass:"title"},[t._v("备注")]),e("textarea",{directives:[{name:"model",rawName:"v-model",value:t.editData.remark,expression:"editData.remark"}],attrs:{rows:"5",placeholder:"请输入备注"},domProps:{value:t.editData.remark},on:{input:function(e){e.target.composing||t.$set(t.editData,"remark",e.target.value)}}})]),e("div",{staticClass:"row"},[e("buttonLib",{attrs:{btnClass:"btn",text:"保存"},on:{click:t.saveEdit}})],1)])]):t._e(),t.isShowNew?e("dialogLib",{attrs:{title:"新建隧道",width:"calc(100vw - 20px);",height:"calc(100vh - 40px);",maxHeight:"calc(100vh - 40px);",hideWithMask:!t.isShowServerSelectBox},on:{hide:t.closeNew}},[e("div",{staticClass:"editFrom"},[e("div",{staticClass:"row"},[e("div",{staticClass:"title req"},[t._v("隧道名称")]),e("input",{directives:[{name:"model",rawName:"v-model",value:t.editData.name,expression:"editData.name"}],attrs:{placeholder:"请输入隧道名称"},domProps:{value:t.editData.name},on:{input:function(e){e.target.composing||t.$set(t.editData,"name",e.target.value)}}})]),e("div",{staticClass:"row"},[e("div",{staticClass:"title req"},[t._v("本地IP")]),e("input",{directives:[{name:"model",rawName:"v-model",value:t.editData.local_addr,expression:"editData.local_addr"}],attrs:{placeholder:"请输入本地IP"},domProps:{value:t.editData.local_addr},on:{input:function(e){e.target.composing||t.$set(t.editData,"local_addr",e.target.value)}}})]),e("div",{staticClass:"row"},[e("div",{staticClass:"title req"},[t._v("本地端口")]),e("input",{directives:[{name:"model",rawName:"v-model",value:t.editData.local_port,expression:"editData.local_port"}],attrs:{placeholder:"请输入本地端口"},domProps:{value:t.editData.local_port},on:{input:function(e){e.target.composing||t.$set(t.editData,"local_port",e.target.value)}}})]),e("div",{staticClass:"row"},[e("div",{staticClass:"title req"},[t._v("服务器")]),e("el-select",{attrs:{placeholder:"请选择服务器",disabled:!0},model:{value:t.editData.server_id,callback:function(e){t.$set(t.editData,"server_id",e)},expression:"editData.server_id"}},t._l(t.serverList,(function(t){return e("el-option",{key:t.id,attrs:{label:t.name,value:t.id}})})),1)],1),e("div",{staticClass:"row"},[e("div",{staticClass:"title req"},[t._v("协议")]),e("el-select",{attrs:{placeholder:"请选择协议"},model:{value:t.editData.protocol,callback:function(e){t.$set(t.editData,"protocol",e)},expression:"editData.protocol"}},t._l(t.serverProtocos,(function(t){return e("el-option",{key:t.value,attrs:{label:t.label,value:t.value}})})),1)],1),"http"==t.editData.protocol||"https"==t.editData.protocol?e("div",{staticClass:"row"},[e("div",{staticClass:"title req"},[t._v("域名")]),t._l(t.domainsRow,(function(a,i){return e("div",{key:"domain_"+i,staticClass:"inputBox"},[e("div",{staticClass:"pre"},[t._v(t._s(t.editData.protocol)+"://")]),e("input",{directives:[{name:"model",rawName:"v-model",value:t.domainsRow[i].domain,expression:"domainsRow[key].domain"}],staticClass:"hasPre hasAppend",attrs:{placeholder:"请输入域名"},domProps:{value:t.domainsRow[i].domain},on:{input:function(e){e.target.composing||t.$set(t.domainsRow[i],"domain",e.target.value)}}}),e("div",{staticClass:"append",on:{click:function(e){return t.deleteDomain(i)}}},[t._v(" 删除 ")])])})),e("div",{staticClass:"addBtn"},[e("buttonLib",{attrs:{btnClass:"btn",text:"添加"},on:{click:t.addDomain}})],1)],2):t._e(),e("div",{staticClass:"row"},[e("div",{staticClass:"title"},[t._v("备注")]),e("textarea",{directives:[{name:"model",rawName:"v-model",value:t.editData.remark,expression:"editData.remark"}],attrs:{rows:"5",placeholder:"请输入备注"},domProps:{value:t.editData.remark},on:{input:function(e){e.target.composing||t.$set(t.editData,"remark",e.target.value)}}})]),e("div",{staticClass:"row"},[e("buttonLib",{attrs:{btnClass:"btn",text:"保存"},on:{click:t.saveNew}})],1)])]):t._e(),t.isShowConfirm?e("dialogLib",{ref:"confirm",attrs:{title:"删除确认",height:"auto","max-width":"300px",isShowClose:!1},on:{hide:function(e){return t.cancelDel(!0)}}},[e("div",{staticClass:"confirm"},[e("div",{staticClass:"row"},[e("div",{staticClass:"title"},[t._v("确定要删除 "),e("span",{staticStyle:{color:"red"}},[t._v(t._s(t.delName))]),t._v(" 吗？")])]),e("div",{staticClass:"row"},[e("buttonLib",{attrs:{btnClass:"btn yes",text:"确定"},on:{click:t.del}}),e("buttonLib",{attrs:{btnClass:"btn no",text:"取消"},on:{click:t.cancelDel}})],1)])]):t._e()],1)},oe=[function(){var t=this,e=t._self._c;return e("div",{staticClass:"row"},[e("div",{staticClass:"title"},[t._v("搜索")])])}],le=(a(1454),{name:"tunnelPage",components:{buttonLib:b,pageLib:zt,dialogLib:T},data(){return{isInit:!0,userInfo:null,URL:window.config.apiUrl,tableData:[],protocols:[],protocolFilter:[],nameFilter:"",localAddrFilter:"",remoteAddrFilter:"",limit:10,page:1,totalPage:1,loading:!1,editId:null,editData:{},delId:null,delName:"",isShowConfirm:!1,isShowNew:!1,serverList:[],isShowServerSelectBox:!1,axiosC:new AbortController,userGroups:[],newProtocolFilter:[],newUserGroupFilter:[],serverProtocos:[],newNameFilter:"",domainsRow:[]}},watch:{protocolFilter:function(){this.isInit||this.debouncedGetData()},nameFilter:function(){this.isInit||this.debouncedGetData()},localAddrFilter:function(){this.isInit||this.debouncedGetData()},remoteAddrFilter:function(){this.isInit||this.debouncedGetData()},newProtocolFilter:"debouncedGetServersData",newUserGroupFilter:"debouncedGetServersData",newNameFilter:"debouncedGetServersData"},methods:{async getUserInfo(){let t=await this.$root.checkLogin();t||("/"!=this.$route.path&&this.$router.replace("/"),this.$root.goLogin()),this.userInfo=t?.data??null},deleteDomain(t){this.domainsRow.splice(t,1)},addDomain(){this.domainsRow.length>2?this.$notify.error({title:"提示",message:"最多只能添加3个域名"}):this.domainsRow.push({id:this.domainsRow.length,domain:""})},async getServerData(){let t=null,e="",a=[];0==this.newProtocolFilter.length?this.protocols.forEach((t=>{a.push(t.value)})):this.newProtocolFilter.forEach((t=>{a.push(t)})),e=a.join(",");let i=this.newUserGroupFilter,s={};s=""!=i&&"all"!=i?{protocol:e,group:i,name:this.newNameFilter}:{protocol:e,name:this.newNameFilter},s.limit=1e3;try{t=await u.A.post(this.URL+"frp/serverList",s,{headers:{token:localStorage.getItem("token")},signal:this.axiosC.signal})}catch(l){this.$root.netError(l)}this.serverList=t?.data?.data?.data;let o=t?.data?.data?.selection;this.userGroups=o?.goups,this.protocols=o?.protocols},openServerSelect(){this.isShowServerSelectBox=!0,this.getServerData()},closeServerSelectBox(){this.isShowServerSelectBox=!1,this.$root.enableMask(!1)},async saveNew(){if(!this.editData?.server_id||""==this.editData?.server_id||!this.editData?.protocol||""==this.editData?.protocol||!this.editData?.name||""==this.editData?.name||!this.editData?.local_addr||""==this.editData?.local_addr||!this.editData?.local_port||""==this.editData?.local_port||"http"==this.editData?.protocol&&(!this.domainsRow||0==this.domainsRow.length)||"https"==this.editData?.protocol&&(!this.domainsRow||0==this.domainsRow.length))return void this.$notify.error({title:"提示",message:"请填写必填项"});this.$root.loading(!0);let t=null,e={serverID:this.editData?.server_id,name:this.editData?.name,localIP:this.editData?.local_addr,localPort:this.editData?.local_port,remark:this.editData?.remark,protocol:this.editData?.protocol};if("http"==this.editData?.protocol||"https"==this.editData?.protocol){let t="";this.domainsRow.forEach((e=>{t+=e.domain+","})),e.domains=t}try{t=await u.A.post(this.URL+"frp/newTunnel",e,{headers:{token:localStorage.getItem("token")??""},signal:this.axiosC.signal})}catch(i){return this.$root.loading(!1),this.domainsRow=[],void(u.A.isCancel&&u.A.isCancel(i)||"CanceledError"===i.name?console.log("用户取消请求"):this.$root.netError(i))}this.$root.loading(!1);let a=t;1==a?.data?.code?(this.$notify.success({title:"提示",message:a?.data?.msg}),this.domainsRow=[],this.closeNew(),this.closeServerSelectBox(),this.getData(this.limit,this.page)):this.$notify.error({title:"提示",message:a?.data?.msg})},newTunnel(t){this.isShowNew=!0,this.editData.server_id=t.id,this.serverProtocos=[],t?.protocol.forEach((t=>{this.serverProtocos.push({value:t,label:t})}))},closeNew(){this.isShowNew=!1,this.editData={}},cancelDel(t=!1){this.$refs?.confirm?.hide(),t&&(this.isShowConfirm=!1,this.delId=null,this.delName="")},delConfirm(t){this.delId=t.id,this.delName=t.name,this.isShowConfirm=!0},async del(){this.$root.loading(!0);let t=null,e={id:this.delId};try{t=await u.A.post(this.URL+"frp/delTunnel",e,{headers:{token:localStorage.getItem("token")??""},signal:this.axiosC.signal})}catch(i){return this.$root.loading(!1),void(u.A.isCancel&&u.A.isCancel(i)||"CanceledError"===i.name?console.log("用户取消请求"):this.$root.netError(i))}this.$root.loading(!1);let a=t;1==a?.data?.code?(this.$notify.success({title:"提示",message:a?.data?.msg}),this.cancelDel(),this.getData(this.limit,this.page)):this.$notify.error({title:"提示",message:a?.data?.msg})},async disable(t){this.$root.loading(!0);let e=null,a={id:t.id,name:t.name,localIP:t.local_addr,localPort:t.local_port,remark:t.remark,status:"normal"==t.status?"hidden":"normal"};try{e=await u.A.post(this.URL+"frp/editTunnel",a,{headers:{token:localStorage.getItem("token")??""},signal:this.axiosC.signal})}catch(s){return this.$root.loading(!1),void(u.A.isCancel&&u.A.isCancel(s)||"CanceledError"===s.name?console.log("用户取消请求"):this.$root.netError(s))}this.$root.loading(!1);let i=e;1==i?.data?.code?(this.$notify.success({title:"提示",message:i?.data?.msg}),this.getData(this.limit,this.page)):this.$notify.error({title:"提示",message:i?.data?.msg})},async saveEdit(){this.$root.loading(!0);let t=null,e={id:this.editId,name:this.editData?.name,localIP:this.editData?.local_addr,localPort:this.editData?.local_port,remark:this.editData?.remark,status:this.editData?.status};try{t=await u.A.post(this.URL+"frp/editTunnel",e,{headers:{token:localStorage.getItem("token")??""},signal:this.axiosC.signal})}catch(i){return this.$root.loading(!1),void(u.A.isCancel&&u.A.isCancel(i)||"CanceledError"===i.name?console.log("用户取消请求"):this.$root.netError(i))}this.$root.loading(!1);let a=t;1==a?.data?.code?(this.$notify.success({title:"提示",message:a?.data?.msg}),this.closeEdit(),this.getData(this.limit,this.page)):this.$notify.error({title:"提示",message:a?.data?.msg})},closeEdit(){this.$root.enableMask(!1),this.editId=null,this.editData={}},edit(t){t=JSON.parse(JSON.stringify(t)),this.editData=t,this.editId=t.id},changePage(t){this.getData(this.limit,t)},async getData(t=10,e=1){this.isInit&&await this.getServerData(),this.page=e,this.loading=!0,this.tableData=[];let a="";0===this.protocolFilter.length&&(this.protocolFilter=this.protocols.map((t=>t.value))),a=this.protocolFilter.join(",");let i={protocol:a,name:this.nameFilter,local_addr:this.localAddrFilter,local_port:this.remoteAddrFilter,limit:t,page:e},s=null;try{s=await u.A.post(this.URL+"frp/tunnelList",i,{headers:{token:localStorage.getItem("token")??""},signal:this.axiosC.signal})}catch(l){return this.loading=!1,void(u.A.isCancel&&u.A.isCancel(l)||"CanceledError"===l.name?console.log("用户取消请求"):this.$root.netError(l))}this.getUserInfo(),this.loading=!1;let o=s?.data?.data;this.totalPage=0===o?.last_page?1:o?.last_page,this.tableData=o?.data.length>0?o.data:[],this.isInit=!1},debouncedGetData:function(){let t=null;return function(){t&&clearTimeout(t),t=setTimeout((()=>{this.getData(this.limit)}),500)}}(),debouncedGetServersData:function(){let t=null;return function(){t&&clearTimeout(t),t=setTimeout((()=>{this.getServerData()}),500)}}()},mounted(){this.$nextTick((()=>{this.getData(this.limit)}))},beforeDestroy(){this.axiosC.abort()}}),ne=le,re=(0,v.A)(ne,se,oe,!1,null,"1791e6c8",null),ce=re.exports,de=function(){var t=this,e=t._self._c;return e("div",{staticClass:"page",attrs:{id:"downloadPage"}},[e("div",{class:t.loading?"card loadingLocal":"card"},[e("div",{staticClass:"cardTitle"},[t._v("软件下载")]),e("div",{staticClass:"top"},t._l(t.data,(function(a,i){return e("div",{key:"soft_"+a.id,class:i==t.activeKey?"item active":"item",on:{click:function(e){return t.changeClinet(a,i)}}},[e("div",{staticClass:"row"},[e("img",{staticClass:"icon",attrs:{src:t.backendUrl+a.img}}),e("div",{staticClass:"name"},[t._v(" "+t._s(a.name)+" ")])])])})),0)]),e("div",{class:t.loading?"card loadingLocal":"card",attrs:{id:"download"}},[e("div",{staticClass:"bottom"},[e("div",{staticClass:"cardTitle"},[t._v("客户端说明")]),e("div",{staticClass:"btnGroup"},[e("buttonLib",{attrs:{text:"下载"},on:{click:t.linkTo}}),e("buttonLib",{staticClass:"help",attrs:{text:"帮助"},on:{click:function(e){return t.$router.replace("/help")}}})],1),e("div",{staticClass:"clinetContent",domProps:{innerHTML:t._s(t.clinetContent)}})])])])},he=[],ue={name:"downloadPage",components:{buttonLib:b},data(){return{URL:window.config.apiUrl,backendUrl:window.config.backendUrl,data:[],axiosC:new AbortController,loading:!1,clinetContent:"",link:"",activeKey:0}},methods:{linkTo(){this.$root.linkTo(this.link,"_blank")},changeClinet(t,e){this.clinetContent=t.content,this.link=t.download,this.activeKey=e,this.$nextTick((()=>{window.scrollTo({top:document.getElementById("download").offsetTop-65,behavior:"smooth"})}))},async getData(){this.loading=!0;let t=null;try{t=await u.A.get(this.URL+"content/software",{headers:{token:localStorage.getItem("token")??""},signal:this.axiosC.signal})}catch(e){return this.loading=!1,void(u.A.isCancel&&u.A.isCancel(e)||"CanceledError"===e.name?console.log("用户取消请求"):this.$root.netError(e))}this.loading=!1,1==t?.data?.code?(this.data=t?.data?.data,this.data.length>0&&(this.clinetContent=this.data[0].content,this.link=this.data[0].download)):this.$notify.error({title:"提示",message:t?.data?.msg})}},mounted(){this.$nextTick((()=>{this.getData()}))}},me=ue,ge=(0,v.A)(me,de,he,!1,null,"af7534ba",null),pe=ge.exports,fe=function(){var t=this,e=t._self._c;return e("div",{staticClass:"page",attrs:{id:"domainAuthPage"}},[e("div",{staticClass:"card"},[e("div",{staticClass:"cardTitle"},[t._v("域名审核")]),e("div",{staticClass:"toolsBar"},[e("div",{staticClass:"row"},[e("el-alert",{attrs:{title:"本页面不是提交备案申请的页面，千鹤FRP不提供任何备案服务",type:"error",effect:"dark",closable:!1}})],1),e("div",{staticClass:"row"},[e("el-alert",{attrs:{title:"创建隧道时仅可使用此处显示已经通过审核的域名",type:"error",effect:"dark",closable:!1}})],1),e("div",{staticClass:"row"},[e("el-alert",{attrs:{title:"提交审核时请输入已经备案完成、可以在工信部系统查到备案信息的域名",type:"error",effect:"dark",closable:!1}})],1),e("div",{staticClass:"row"},[e("el-alert",{attrs:{title:"提交审核后 系统将在5-10分钟内自动对域名备案情况进行审核",type:"info",effect:"dark",closable:!1}})],1),e("div",{staticClass:"row"},[e("el-alert",{attrs:{title:"若审核未通过但工作人员没有手动拒绝 则系统将实时监控域名备案状态 直到备案通过或用户手动删除",type:"error",effect:"dark",closable:!1}})],1),e("div",{staticClass:"row"},[e("el-alert",{attrs:{title:"每个用户仅可使用"+t.limit+"个域名 您可用通过删除域名来释放额度",type:"info",effect:"dark",closable:!1}})],1)]),e("div",{staticClass:"toolsBar"},[e("div",{staticClass:"row"},[e("div",{staticClass:"btnGroup"},[e("buttonLib",{attrs:{btnClass:"btn",text:"提交审核"},on:{click:t.openSubmitBox}}),e("buttonLib",{attrs:{btnClass:"btn",text:"刷新"},on:{click:function(e){return t.getData()}}})],1)])]),e("div",{class:t.loading?"tableBox loadingLocal":"tableBox"},[0==t.tableData.length?e("div",{staticClass:"empty"}):t._e(),t._l(t.tableData,(function(a,i){return e("div",{key:"tableData_"+i,staticClass:"tableLine"},[e("el-table",{staticStyle:{width:"100%"},attrs:{data:[a],border:"","show-header":!1,"row-class-name":"tableTitle"}},[e("el-table-column",{attrs:{"class-name":"no-bottom-border",prop:"domain",resizable:!1}})],1),e("el-table",{staticStyle:{width:"100%"},attrs:{data:[a],border:"",size:"mini"}},[e("el-table-column",{attrs:{prop:"status",label:"状态",resizable:!1},scopedSlots:t._u([{key:"default",fn:function(a){return[0==a.row.status?e("el-tag",{attrs:{type:"success"}},[t._v("已通过")]):t._e(),1==a.row.status?e("el-tag",{attrs:{type:"info"}},[t._v("暂未通过")]):t._e(),2==a.row.status?e("el-tag",{attrs:{type:"danger"}},[t._v("已拒绝")]):t._e()]}}],null,!0)}),e("el-table-column",{attrs:{label:"操作",resizable:!1},scopedSlots:t._u([{key:"default",fn:function(a){return[e("div",{staticClass:"btnGroup"},[e("buttonLib",{staticClass:"btn",attrs:{text:"删除"},on:{click:function(e){return t.del(a.row)}}})],1)]}}],null,!0)})],1)],1)}))],2),t.isShowConfirm?e("dialogLib",{ref:"dialog",attrs:{title:"删除确认",height:"auto","max-width":"400px",isShowClose:!1},on:{hide:t.cancelDel}},[e("div",{staticClass:"confirm"},[e("div",{staticClass:"row"},[e("div",{staticClass:"title"},[t._v("确定要删除 "),e("span",{staticStyle:{color:"red"}},[t._v(t._s(t.delName))]),t._v(" 吗?")])]),e("div",{staticClass:"row"},[e("el-alert",{attrs:{title:"已审核的域名删除后重新提交,需要重新审核.",type:"error",center:"",closable:!1}})],1),e("div",{staticClass:"row"},[e("buttonLib",{attrs:{btnClass:"btn yes",text:"确定"},on:{click:t.doDel}}),e("buttonLib",{attrs:{btnClass:"btn no",text:"取消"},on:{click:t.cancelDel}})],1)])]):t._e(),t.isShowSubmitBox?e("dialogLib",{ref:"dialog",attrs:{title:"提交域名审核",height:"auto","max-width":"400px",isShowClose:!t.submitLoading},on:{hide:t.closeSubmitBox}},[e("div",{class:t.submitLoading?"form loadingLocal":"form"},[e("div",{staticClass:"row"},[e("el-alert",{attrs:{title:"请输入已经备案完成、可以在工信部系统查到备案信息的域名",type:"error",center:"",closable:!1}})],1),e("div",{staticClass:"row"},[e("div",{staticClass:"title"},[t._v("域名")]),e("div",{staticClass:"inputBox"},[e("div",{staticClass:"pre"},[t._v("http://")]),e("input",{directives:[{name:"model",rawName:"v-model",value:t.form.domain,expression:"form.domain"}],staticClass:"hasPre",attrs:{placeholder:"请输入域名"},domProps:{value:t.form.domain},on:{input:function(e){e.target.composing||t.$set(t.form,"domain",e.target.value)}}})])]),e("div",{staticClass:"row"},[e("buttonLib",{attrs:{btnClass:"btn",text:"提交"},on:{click:t.submit}})],1)])]):t._e()],1)])},ve=[],Ce={name:"domainAuthPage",components:{buttonLib:b,dialogLib:T},data(){return{loading:!1,submitLoading:!1,tableData:[],URL:window.config.apiUrl,limit:0,userInfo:null,axiosC:new AbortController,isShowConfirm:!1,delName:"",delId:"",isShowSubmitBox:!1,form:{domain:""}}},methods:{async submit(){this.loading=!0;let t=null;try{t=await u.A.post(this.URL+"frp/domainAuth",{domain:this.form.domain},{headers:{token:localStorage.getItem("token")??""},signal:this.axiosC.signal})}catch(e){return this.loading=!1,void(u.A.isCancel&&u.A.isCancel(e)||"CanceledError"===e.name?console.log("用户取消请求"):this.$root.netError(e))}this.loading=!1,1==t?.data?.code?(this.$notify.success({title:"提示",message:"提交成功"}),this.closeSubmitBox(),this.getData()):this.$notify.error({title:"提示",message:t?.data?.msg})},closeSubmitBox(){this.$refs?.dialog?.hide(),this.isShowSubmitBox=!1,this.form.domain=""},openSubmitBox(){this.isShowSubmitBox=!0},cancelDel(){this.$refs.dialog.hide(),this.isShowConfirm=!1,this.delName="",this.delId=""},del(t){this.delName=t.domain,this.isShowConfirm=!0,this.delId=t.id},async doDel(){this.loading=!0;let t=null;this.$refs.dialog.hide(),this.isShowConfirm=!1,this.delName="";try{t=await u.A.post(this.URL+"frp/delDomain",{id:this.delId},{headers:{token:localStorage.getItem("token")??""},signal:this.axiosC.signal}),this.delId=""}catch(e){return this.loading=!1,void(u.A.isCancel&&u.A.isCancel(e)||"CanceledError"===e.name?console.log("用户取消请求"):this.$root.netError(e))}this.loading=!1,1==t?.data?.code?(this.$notify.success({title:"提示",message:"删除成功"}),this.getData()):this.$notify.error({title:"提示",message:t?.data?.msg})},async getData(){this.loading=!0,this.tableData=[];let t=null;try{t=await u.A.get(this.URL+"frp/domainsList",{headers:{token:localStorage.getItem("token")??""},signal:this.axiosC.signal})}catch(e){return this.loading=!1,void(u.A.isCancel&&u.A.isCancel(e)||"CanceledError"===e.name?console.log("用户取消请求"):this.$root.netError(e))}this.loading=!1,1==t?.data?.code?(this.tableData=t?.data?.data?.data,this.limit=t?.data?.data?.limit):this.$notify.error({title:"提示",message:t?.data?.msg})}},mounted(){this.$nextTick((()=>{this.getData()}))},beforeDestroy(){this.axiosC.abort()}},be=Ce,we=(0,v.A)(be,fe,ve,!1,null,"4ab5c132",null),_e=we.exports,ye=function(){var t=this,e=t._self._c;return e("div",{staticClass:"page",attrs:{id:"ticketPage"}},[e("div",{staticClass:"card"},[e("div",{staticClass:"cardTitle"},[t._v("工单列表")]),e("div",{staticClass:"toolsBar"},[e("div",{staticClass:"row"},[e("div",{staticClass:"btnGroup"},[e("buttonLib",{attrs:{btnClass:"btn",text:"发起工单"},on:{click:t.newTicket}}),e("buttonLib",{attrs:{btnClass:"btn",text:"刷新"},on:{click:function(e){return t.getData(t.limit,1)}}})],1)])]),e("div",{class:t.loading?"tableBox loadingLocal":"tableBox"},[0==t.tableData.length?e("div",{staticClass:"empty"}):t._e(),t._l(t.tableData,(function(a,i){return e("div",{key:"tableData_"+i,staticClass:"tableLine"},[e("el-table",{staticStyle:{width:"100%"},attrs:{data:[a],border:"","show-header":!1,"row-class-name":"tableTitle"}},[e("el-table-column",{attrs:{"class-name":"no-bottom-border",resizable:!1},scopedSlots:t._u([{key:"default",fn:function(e){return[t._v(" "+t._s(t.$root.shortStr(e.row.title))+" ")]}}],null,!0)}),e("el-table-column",{attrs:{prop:"status",width:"90","class-name":"no-bottom-border",resizable:!1},scopedSlots:t._u([{key:"default",fn:function(a){return[0===a.row.status?e("el-tag",{attrs:{type:"info"}},[t._v("等待回复")]):t._e(),1===a.row.status?e("el-tag",{attrs:{type:"success"}},[t._v("已回复")]):t._e(),2===a.row.status?e("el-tag",{attrs:{type:"danger"}},[t._v("已关闭")]):t._e()]}}],null,!0)})],1),e("el-table",{staticStyle:{width:"100%"},attrs:{data:[a],border:"",size:"mini"}},[e("el-table-column",{attrs:{label:"操作",resizable:!1},scopedSlots:t._u([{key:"default",fn:function(a){return[e("div",{staticClass:"btnGroup"},[e("buttonLib",{attrs:{btnClass:"rowBtn",size:"small",text:"查看"},on:{click:function(e){return t.showTicket(a.row)}}}),0===a.row.status||1===a.row.status?e("buttonLib",{attrs:{btnClass:"rowBtn",size:"small",text:"关闭"},on:{click:function(e){return t.closeTicket(a.row)}}}):t._e(),2===a.row.status?e("buttonLib",{attrs:{btnClass:"rowBtn",size:"small",text:"删除"},on:{click:function(e){return t.delTicket(a.row)}}}):t._e()],1)]}}],null,!0)})],1)],1)})),e("div",{staticClass:"pagenation"},[e("pageLib",{attrs:{total:t.totalPage,page:t.currentPage},on:{change:t.changePage}})],1)],2),t.showTicketContent?e("dialogLib",{ref:"detail",attrs:{title:"工单详情",width:"calc(100vw - 20px);",height:"calc(100vh - 40px);",maxHeight:"calc(100vh - 40px);"},on:{hide:t.closeDetail}},[e("div",{ref:"detailContent",class:t.dialogLoading?"detail loadingLocal":"detail"},[e("div",{staticClass:"title"},[t._v("工单编号:"+t._s(t.detailData[0]?.no))]),t._l(t.detailData,(function(a,i){return e("div",{key:"detail_"+i,class:"user"==a.role?"row right":"row"},[e("div",{staticClass:"role"},[t._v(" "+t._s("user"==a.role?"我":"客服人员")+" "+t._s(t.$root.getDate(a.createtime))+" ")]),e("div",{staticClass:"msg"},[t._v(" "+t._s(a.content)+" ")])])}))],2),e("div",{staticClass:"inputBox"},[e("textarea",{directives:[{name:"model",rawName:"v-model",value:t.reForm.content,expression:"reForm.content"}],class:t.disabled?"disabled":"",attrs:{rows:"6",disabled:t.disabled,placeholder:"请输入内容"},domProps:{value:t.reForm.content},on:{input:function(e){e.target.composing||t.$set(t.reForm,"content",e.target.value)}}}),e("div",{class:t.disabled?"send disabled":"send",on:{click:t.replyBtn}},[t._v(" 发送 ")])])]):t._e(),t.isShowHcaptcha?e("dialogLib",{attrs:{title:"人机验证",hideWithMask:!1,height:"auto","max-width":"400px"},on:{hide:t.closeHcaptcha}},[e("vue-hcaptcha",{attrs:{sitekey:t.hCaptchaKey},on:{verify:t.hcapResult}})],1):t._e(),t.isShowConfirm?e("dialogLib",{ref:"confirm",attrs:{title:"二次确认",isShowClose:!1,height:"auto","max-width":"400px"},on:{hide:t.hideConfirm}},[e("div",{staticClass:"confirm"},[e("div",{staticClass:"row"},[e("div",{staticClass:"title"},[t._v(t._s(t.confirmTitle))])]),e("div",{staticClass:"row"},[e("div",{staticClass:"content",domProps:{innerHTML:t._s(t.confirmContent)}})]),e("div",{staticClass:"row"},[e("buttonLib",{attrs:{btnClass:"btn yes",text:"确定"},on:{click:t.confirmYes}}),e("buttonLib",{attrs:{btnClass:"btn no",text:"取消"},on:{click:t.confirmNo}})],1)])]):t._e(),t.isShowNewTicket?e("dialogLib",{ref:"newTicket",attrs:{title:"发起工单",height:"auto","max-height":"80vh","max-width":"400px"},on:{hide:t.hideNewTicket}},[e("div",{staticClass:"newTicket"},[e("div",{staticClass:"row"},[e("el-alert",{attrs:{title:"工单系统仅用于真实问题反馈，请勿随意提交无关信息。若出现恶意或过度滥用，您的账号可能会被限制使用。",type:"error",effect:"dark",closable:!1}})],1),e("div",{staticClass:"row"},[e("textarea",{directives:[{name:"model",rawName:"v-model",value:t.newTicketFrom.content,expression:"newTicketFrom.content"}],attrs:{rows:"10",placeholder:"请输入内容"},domProps:{value:t.newTicketFrom.content},on:{input:function(e){e.target.composing||t.$set(t.newTicketFrom,"content",e.target.value)}}})]),e("div",{staticClass:"row"},[e("buttonLib",{attrs:{btnClass:"btn",text:"提交"},on:{click:t.newTicketBtn}})],1)])]):t._e()],1)])},ke=[],xe={name:"ticketPage",components:{buttonLib:b,pageLib:zt,dialogLib:T,VueHcaptcha:h()},data(){return{loading:!1,dialogLoading:!1,URL:window.config.apiUrl,axiosC:new AbortController,tableData:[],totalPage:1,currentPage:1,limit:10,detailData:[],showTicketContent:!1,disabled:!1,isShowConfirm:!1,confirmTitle:"",confirmContent:"",confirmAction:function(){console.log("二次确认")},reForm:{code:"",no:"",content:""},hCaptchaKey:window.config.hCaptcha,hCaptchaType:"newTicket",isShowHcaptcha:!1,isShowNewTicket:!1,newTicketFrom:{code:"",content:""}}},methods:{async submitTicket(){let t=null;this.$root.loading(!0);try{t=await u.A.post(this.URL+"ticket/submit",this.newTicketFrom,{headers:{token:localStorage.getItem("token")??""},signal:this.axiosC.signal})}catch(e){return this.$root.loading(!1),void(u.A.isCancel&&u.A.isCancel(e)||"CanceledError"===e.name?console.log("用户取消请求"):this.$root.netError(e))}this.$root.loading(!1),this.$refs.newTicket?.hide(),1==t?.data?.code?(this.$notify.success({title:"提示",message:"提交成功"}),this.getData(this.limit,1)):this.$notify.error({title:"提示",message:t?.data?.msg})},newTicketBtn(){""!=this.newTicketFrom?.content?(this.hCaptchaType="new",this.isShowHcaptcha=!0):this.$notify.error({title:"提示",message:"请填写工单内容"})},newTicket(){this.isShowNewTicket=!0},hideNewTicket(){this.isShowNewTicket=!1,this.newTicketFrom.content=""},hideConfirm(){this.isShowConfirm=!1},confirmYes(){this.confirmAction(),this.$refs.confirm?.hide()},confirmNo(){this.$refs.confirm?.hide()},replyBtn(){""!=this.reForm?.content?(this.hCaptchaType="reply",this.isShowHcaptcha=!0):this.$notify.error({title:"提示",message:"请填写回复内容"})},closeHcaptcha(){this.isShowHcaptcha=!1},async hcapResult(t){"reply"==this.hCaptchaType&&(this.reForm.code=t,this.reForm.no=this.detailData[0]?.no),"new"==this.hCaptchaType&&(this.newTicketFrom.code=t),t&&(this.closeHcaptcha(),"reply"==this.hCaptchaType&&(await this.sendReply(),this.reForm={code:"",no:"",content:""},this.$refs.detail?.hide()),"new"==this.hCaptchaType&&(await this.submitTicket(),this.newTicketFrom={code:"",content:""},this.$refs.newTicket?.hide()),this.getData(this.limit,1))},async sendReply(){let t=null;this.$root.loading(!0);try{t=await u.A.post(this.URL+"ticket/reply",this.reForm,{headers:{token:localStorage.getItem("token")??""},signal:this.axiosC.signal})}catch(e){return this.$root.loading(!1),void(u.A.isCancel&&u.A.isCancel(e)||"CanceledError"===e.name?console.log("用户取消请求"):this.$root.netError(e))}this.$root.loading(!1),this.$notify.error({title:"提示",message:t?.data?.msg})},closeTicket(t){this.confirmAction=function(){this.doTicketAction(t,"close")},this.confirmTitle="确定要关闭工单吗？",this.confirmContent="您即将关闭以下工单:<br><span style='color:red;'>"+t?.no+"</span><br>关闭后,该工单将无法再进行回复",this.isShowConfirm=!0},delTicket(t){this.confirmAction=function(){this.doTicketAction(t,"del")},this.confirmTitle="确定要删除工单吗？",this.confirmContent="您即将删除以下工单:<br><span style='color:red;'>"+t?.no+"</span><br>删除后,该工单将不会出现在工单列表.同时无法找回",this.isShowConfirm=!0},async doTicketAction(t,e="close"){let a=null,i={no:t?.no,action:e};this.$root.loading(!0);try{a=await u.A.post(this.URL+"ticket/close",i,{headers:{token:localStorage.getItem("token")??""},signal:this.axiosC.signal})}catch(s){return this.$root.loading(!1),void(u.A.isCancel&&u.A.isCancel(s)||"CanceledError"===s.name?console.log("用户取消请求"):this.$root.netError(s))}this.$root.loading(!1),1==a?.data?.code?(this.$notify.success({title:"提示",message:a?.data?.msg}),this.getData(this.limit,1)):this.$notify.error({title:"提示",message:a?.data?.msg})},closeDetail(){this.showTicketContent=!1,this.detailData=[]},showTicket(t){this.showTicketContent=!0,this.disabled=2==t?.status,this.getDetail(t.no)},changePage(t){this.getData(this.limit,t)},async getDetail(t){let e=null;this.dialogLoading=!0;try{e=await u.A.get(this.URL+"ticket/view?no="+t,{headers:{token:localStorage.getItem("token")??""},signal:this.axiosC.signal})}catch(a){return this.dialogLoading=!1,void(u.A.isCancel&&u.A.isCancel(a)||"CanceledError"===a.name?console.log("用户取消请求"):this.$root.netError(a))}this.dialogLoading=!1,1==e?.data?.code?(this.detailData=e?.data?.data,this.$refs.detailContent&&this.$nextTick((()=>{this.$refs.detailContent.scrollTo({top:this.$refs.detailContent.scrollHeight,behavior:"smooth"})}))):this.$notify.error({title:"提示",message:e?.data?.msg})},async getData(t=10,e=1){this.loading=!0,this.tableData=[],this.currentPage=e;let a=null;try{a=await u.A.get(this.URL+"ticket/list?page="+e+"&limit="+t,{headers:{token:localStorage.getItem("token")??""},signal:this.axiosC.signal})}catch(s){return this.loading=!1,void(u.A.isCancel&&u.A.isCancel(s)||"CanceledError"===s.name?console.log("用户取消请求"):this.$root.netError(s))}this.loading=!1;let i=a?.data?.data;this.totalPage=i?.last_page,this.tableData=i?.data}},mounted(){this.$nextTick((()=>{this.getData(this.limit,1)}))},beforeDestroy(){this.axiosC.abort()}},$e=xe,Le=(0,v.A)($e,ye,ke,!1,null,"79f64f01",null),Se=Le.exports,De=function(){var t=this,e=t._self._c;return e("div",{staticClass:"page",attrs:{id:"userPage"}},[e("el-tabs",{model:{value:t.activeName,callback:function(e){t.activeName=e},expression:"activeName"}},[e("el-tab-pane",{attrs:{label:"卡密激活",name:"usecard"}},[e("useCard",{on:{finish:t.reloadData}})],1),e("el-tab-pane",{attrs:{label:"我的卡密",name:"cardlist"}},[e("div",{staticClass:"cardTable card"},[e("div",{staticClass:"cardTitle"},[t._v("我的卡密")]),e("div",{staticClass:"toolsBar"},[e("div",{staticClass:"row"},[e("div",{staticClass:"title"},[t._v("搜索")])]),e("div",{staticClass:"row"},[e("input",{directives:[{name:"model",rawName:"v-model",value:t.searchCode,expression:"searchCode"}],attrs:{type:"text",placeholder:"请输入卡密",clearable:""},domProps:{value:t.searchCode},on:{input:function(e){e.target.composing||(t.searchCode=e.target.value)}}})]),e("div",{staticClass:"row"},[e("div",{staticClass:"btnGroup"},[e("buttonLib",{attrs:{btnClass:"btn",text:"刷新"},on:{click:function(e){return t.reloadData()}}}),e("buttonLib",{attrs:{btnClass:"btn",text:"清空筛选"},on:{click:function(e){t.searchCode=""}}})],1)])]),e("div",{class:t.loading?"tableBox loadingLocal":"tableBox"},[e("el-table",{staticStyle:{width:"100%"},attrs:{data:t.cardsData,border:"","row-class-name":"tableRow"},on:{"sort-change":t.sortChange}},[e("el-table-column",{attrs:{type:"expand",resizable:!1},scopedSlots:t._u([{key:"default",fn:function(a){return[e("div",{staticClass:"expand"},[e("div",{staticClass:"item"},[e("span",{staticClass:"lable"},[t._v("卡密名称:")]),e("span",{staticClass:"value"},[t._v(t._s(a.row.name))])]),e("div",{staticClass:"item"},[e("span",{staticClass:"lable"},[t._v("卡密:")]),e("br"),e("span",{staticClass:"value"},[t._v(t._s(a.row.code))])]),e("div",{staticClass:"item"},[e("span",{staticClass:"lable"},[t._v("包含隧道(个):")]),e("span",{staticClass:"value"},[t._v(t._s(a.row.tunnels_num))])]),e("div",{staticClass:"item"},[e("span",{staticClass:"lable"},[t._v("包含流量(MB):")]),e("span",{staticClass:"value"},[t._v(t._s(a.row.traffic_amount))])]),e("div",{staticClass:"item"},[e("span",{staticClass:"lable"},[t._v("会员等级:")]),e("span",{staticClass:"value"},[t._v(t._s(a.row?.level_text?a.row.level_text:"无"))])]),e("div",{staticClass:"item"},[e("span",{staticClass:"lable"},[t._v("有效期至:")]),e("span",{staticClass:"value"},[t._v(t._s(t.$root.getDate(a.row.exptime)))])]),e("div",{staticClass:"item"},[e("span",{staticClass:"lable"},[t._v("使用时间:")]),e("span",{staticClass:"value"},[t._v(t._s(t.$root.getDate(a.row.usetime)))])]),e("div",{staticClass:"item"},[e("span",{staticClass:"lable"},[t._v("包含隧道(个):")]),e("span",{staticClass:"value"},[t._v(t._s(a.row.tunnels_num))])]),e("div",{staticClass:"item"},[e("span",{staticClass:"lable"},[t._v("包含隧道(个):")]),e("span",{staticClass:"value"},[t._v(t._s(a.row.tunnels_num))])]),e("div",{staticClass:"item"},[e("span",{staticClass:"lable"},[t._v("包含隧道(个):")]),e("span",{staticClass:"value"},[t._v(t._s(a.row.tunnels_num))])])])]}}])}),e("el-table-column",{attrs:{prop:"name",label:"卡密名称",sortable:"custom",resizable:!1}}),e("el-table-column",{attrs:{prop:"status",label:"卡密状态",sortable:"custom",resizable:!1},scopedSlots:t._u([{key:"default",fn:function(a){return[1==a.row.status?e("el-tag",{attrs:{type:"success"}},[t._v("使用中")]):t._e(),2==a.row.status?e("el-tag",{attrs:{type:"danger"}},[t._v("已到期")]):t._e(),3==a.row.status?e("el-tag",{attrs:{type:"info"}},[t._v("已折算")]):t._e(),a.row.traffic_status&&""!=a.row.traffic_status?e("el-tag",{attrs:{type:"danger"}},[t._v("流量已用尽")]):t._e()]}}])})],1),e("div",{staticClass:"pagenation"},[e("pageLib",{attrs:{total:t.totalPage,page:t.currentPage},on:{change:t.changePage}})],1)],1)])]),e("el-tab-pane",{attrs:{label:"用户信息",name:"userdata"}},[e("userData",{attrs:{userInfo:t.userInfo}})],1),e("el-tab-pane",{attrs:{label:"用户配置",name:"userconfig"}},[e("div",{staticClass:"controller card"},[e("div",{staticClass:"cardTitle"},[t._v("操作")]),e("ul",[e("li",[e("div",{staticClass:"controllerBtn",on:{click:function(e){t.isShowChangepwd=!0}}},[t._v("修改密码")])]),e("li",[e("div",{staticClass:"controllerBtn",on:{click:function(e){t.isShowChangeemail=!0}}},[t._v("修改邮箱")])]),e("li",[e("div",{staticClass:"line"},[t._v(" 通知设置 "),e("el-tooltip",{staticClass:"help",attrs:{effect:"dark",content:"打开相应通知开关,即可即时收到邮件通知提醒",placement:"top"}},[e("i",{staticClass:"icon el-icon-question"})])],1)]),e("li",[e("div",{staticClass:"switch"},[e("el-switch",{attrs:{"active-color":"#b81010","inactive-color":"#C0C4CC"},model:{value:t.isOpenTrafficAlert,callback:function(e){t.isOpenTrafficAlert=e},expression:"isOpenTrafficAlert"}}),e("span",[t._v(t._s(t.isOpenTrafficAlert?"流量预警已开启":"流量预警已关闭"))])],1),t.isOpenTrafficAlert?e("div",{staticClass:"inputBox"},[e("div",{staticClass:"pre"},[t._v("预警阈值")]),e("input",{directives:[{name:"model",rawName:"v-model",value:t.notifyConfigForm.traffic,expression:"notifyConfigForm.traffic"}],staticClass:"hasAppend hasPre",attrs:{type:"number",placeholder:"请输入流量预警阈值(MB)"},domProps:{value:t.notifyConfigForm.traffic},on:{input:function(e){e.target.composing||t.$set(t.notifyConfigForm,"traffic",e.target.value)}}}),e("div",{staticClass:"append"},[t._v("MB")])]):t._e(),t.isOpenTrafficAlert?e("buttonLib",{staticClass:"saveBtn",attrs:{size:"small",text:"保存"},on:{click:t.saveNotifyConfig}}):t._e()],1),e("li",[e("div",{staticClass:"switch"},[e("el-switch",{attrs:{"active-color":"#b81010","inactive-color":"#C0C4CC"},model:{value:t.isOpenEXPAlert,callback:function(e){t.isOpenEXPAlert=e},expression:"isOpenEXPAlert"}}),e("span",[t._v(t._s(t.isOpenEXPAlert?"卡密临期提醒已开启":"卡密临期提醒已关闭"))])],1),t.isOpenEXPAlert?e("div",{staticClass:"inputBox"},[e("div",{staticClass:"pre"},[t._v("临期天数")]),e("input",{directives:[{name:"model",rawName:"v-model",value:t.notifyConfigForm.cardday,expression:"notifyConfigForm.cardday"}],staticClass:"hasAppend hasPre",attrs:{type:"number",placeholder:"请临期天数"},domProps:{value:t.notifyConfigForm.cardday},on:{input:function(e){e.target.composing||t.$set(t.notifyConfigForm,"cardday",e.target.value)}}}),e("div",{staticClass:"append"},[t._v("天")])]):t._e(),t.isOpenEXPAlert?e("buttonLib",{staticClass:"saveBtn",attrs:{size:"small",text:"保存"},on:{click:t.saveNotifyConfig}}):t._e()],1)])]),t.isShowChangepwd?e("dialogLib",{ref:"changepwd",attrs:{title:"修改密码",maxWidth:"400px",height:"auto"},on:{hide:function(e){t.isShowChangepwd=!1}}},[e("div",{staticClass:"changepwd"},[e("div",{staticClass:"item"},[e("el-alert",{attrs:{title:"我们将向您绑定的邮箱发送一封包含验证码的邮件,请查收后填入下方的验证码输入框。",type:"info",closable:!1,effect:"dark"}})],1),e("div",{staticClass:"item"},[e("div",{staticClass:"lable"},[t._v("验证码")]),e("div",{staticClass:"row"},[e("div",{staticClass:"value"},[e("input",{directives:[{name:"model",rawName:"v-model",value:t.changepwdForm.code,expression:"changepwdForm.code"}],attrs:{placeholder:"请输入验证码"},domProps:{value:t.changepwdForm.code},on:{input:function(e){e.target.composing||t.$set(t.changepwdForm,"code",e.target.value)}}})]),e("buttonLib",{attrs:{btnClass:"btn",text:"获取验证码"},on:{click:t.getpwdToken}})],1)]),e("div",{staticClass:"item"},[e("div",{staticClass:"lable"},[t._v("新密码")]),e("div",{staticClass:"row"},[e("div",{staticClass:"value"},[e("input",{directives:[{name:"model",rawName:"v-model",value:t.changepwdForm.newpwd,expression:"changepwdForm.newpwd"}],attrs:{type:"password",placeholder:"请输入新密码"},domProps:{value:t.changepwdForm.newpwd},on:{input:function(e){e.target.composing||t.$set(t.changepwdForm,"newpwd",e.target.value)}}})])])]),e("div",{staticClass:"item"},[e("div",{staticClass:"lable"},[t._v("确认密码")]),e("div",{staticClass:"row"},[e("div",{staticClass:"value"},[e("input",{directives:[{name:"model",rawName:"v-model",value:t.changepwdForm.confirmpwd,expression:"changepwdForm.confirmpwd"}],attrs:{type:"password",placeholder:"请再次输入密码"},domProps:{value:t.changepwdForm.confirmpwd},on:{input:function(e){e.target.composing||t.$set(t.changepwdForm,"confirmpwd",e.target.value)}}})])])]),e("div",{staticClass:"btnBox"},[e("buttonLib",{attrs:{btnClass:"btn",text:"确认修改"},on:{click:t.changepwd}})],1)])]):t._e(),t.isShowChangeemail?e("dialogLib",{ref:"changeemail",attrs:{title:"修改邮箱",maxWidth:"400px",height:"auto"},on:{hide:function(e){t.isShowChangeemail=!1}}},[e("div",{staticClass:"changeemail"},[e("div",{staticClass:"item"},[e("el-alert",{attrs:{title:"我们将向您当前绑定的邮箱和新邮箱分别发送一封包含验证码的邮件,请查收后填入相应的验证码输入框。",type:"info",closable:!1,effect:"dark"}})],1),e("div",{staticClass:"item"},[e("div",{staticClass:"lable"},[t._v("当前邮箱验证码")]),e("div",{staticClass:"row"},[e("div",{staticClass:"value"},[e("input",{directives:[{name:"model",rawName:"v-model",value:t.changeemailForm.code,expression:"changeemailForm.code"}],attrs:{placeholder:"请输入当前邮箱收到的验证码"},domProps:{value:t.changeemailForm.code},on:{input:function(e){e.target.composing||t.$set(t.changeemailForm,"code",e.target.value)}}})]),e("buttonLib",{attrs:{btnClass:"btn",text:"获取验证码"},on:{click:function(e){return t.getemailToken("changeemailS1")}}})],1)]),e("div",{staticClass:"item"},[e("div",{staticClass:"lable"},[t._v("新邮箱地址")]),e("div",{staticClass:"row"},[e("div",{staticClass:"value"},[e("input",{directives:[{name:"model",rawName:"v-model",value:t.changeemailForm.email,expression:"changeemailForm.email"}],attrs:{placeholder:"请输入新邮箱地址"},domProps:{value:t.changeemailForm.email},on:{input:function(e){e.target.composing||t.$set(t.changeemailForm,"email",e.target.value)}}})]),e("buttonLib",{attrs:{btnClass:"btn",text:"获取验证码"},on:{click:function(e){return t.getemailToken("changeemailS2")}}})],1)]),e("div",{staticClass:"item"},[e("div",{staticClass:"lable"},[t._v("新邮箱验证码")]),e("div",{staticClass:"row"},[e("div",{staticClass:"value"},[e("input",{directives:[{name:"model",rawName:"v-model",value:t.changeemailForm.newcode,expression:"changeemailForm.newcode"}],attrs:{placeholder:"请输入新邮箱收到的验证码"},domProps:{value:t.changeemailForm.newcode},on:{input:function(e){e.target.composing||t.$set(t.changeemailForm,"newcode",e.target.value)}}})])])]),e("div",{staticClass:"btnBox"},[e("buttonLib",{attrs:{btnClass:"btn",text:"确认修改"},on:{click:function(e){return t.changeEmail()}}})],1)])]):t._e()],1)],1),t.isShowHcaptcha?e("dialogLib",{ref:"hcaptcha",attrs:{title:"人机验证",hideWithMask:!1,height:"auto","max-width":"400px"},on:{hide:t.closeHcaptcha}},[e("vue-hcaptcha",{attrs:{sitekey:t.hCaptchaKey},on:{verify:t.hcapResult}})],1):t._e()],1)},Fe=[],Ae=function(){var t=this,e=t._self._c;return e("div",{staticClass:"useCard card"},[e("div",{staticClass:"cardTitle"},[e("div",[t._v("卡密激活")]),e("div",{staticClass:"btn",on:{click:function(e){return t.$root.linkTo("/mall")}}},[e("i",{staticClass:"icon el-icon-s-shop"}),t._v(" 前去购买 ")])]),e("div",{staticClass:"useInputBox"},[e("input",{directives:[{name:"model",rawName:"v-model",value:t.form.cardCode,expression:"form.cardCode"}],staticClass:"cardInput",attrs:{type:"text",placeholder:"请输入卡密"},domProps:{value:t.form.cardCode},on:{input:function(e){e.target.composing||t.$set(t.form,"cardCode",e.target.value)}}}),e("buttonLib",{attrs:{text:"激活"},on:{click:t.showHcaptcha}})],1),""!=t.alertContent?e("dialogLib",{ref:"confirm",attrs:{title:"折算提醒",height:"auto","max-width":"400px",isShowClose:!1},on:{hide:function(e){return t.closeConfirm(!0)}}},[e("div",{staticClass:"confirm",domProps:{innerHTML:t._s(t.alertContent)}}),e("div",{staticClass:"help",on:{click:function(e){return t.$root.linkTo("/#/help","_blank")}}},[t._v(" 点击查看详细折算规则 ")]),e("div",{staticClass:"confirmBtn"},[e("buttonLib",{staticClass:"btn yes",attrs:{text:"我已知晓折算规则-确认激活"},on:{click:function(e){return t.showHcaptcha(!0)}}}),e("buttonLib",{staticClass:"btn no",attrs:{text:"取消"},on:{click:t.closeConfirm}})],1)]):t._e(),t.isShowHcaptcha?e("dialogLib",{ref:"hcaptcha",attrs:{title:"人机验证",height:"auto","max-width":"400px"},on:{hide:t.closeHcaptcha}},[e("vue-hcaptcha",{attrs:{sitekey:t.hCaptchaKey},on:{verify:t.hcapResult}})],1):t._e()],1)},Te=[],Pe={name:"useCard",components:{buttonLib:b,dialogLib:T,VueHcaptcha:h()},data:function(){return{URL:window.config.apiUrl,axiosC:new AbortController,alertContent:"",isShowHcaptcha:!1,form:{code:"",cardCode:""},isConfirm:!1,hCaptchaKey:window.config.hCaptcha}},methods:{closeHcaptcha(){this.isShowHcaptcha=!1},async hcapResult(t){this.form.code=t,t&&(this.$refs?.hcaptcha?.hide(),await this.useCard(this.isConfirm,t))},async showHcaptcha(t=!1){""!=this.form.cardCode?(this.isConfirm=t,this.isShowHcaptcha=!0):this.$notify.error({title:"提示",message:"请输入卡密"})},closeConfirm(t=!1){this.$refs?.confirm?.hide(),t&&(this.alertContent="")},async useCard(t=!1,e=""){let a=null;this.$root.loading(!0);try{let i=null;i=t?{code:e,confirm:t,cardCode:this.form.cardCode}:{cardCode:this.form.cardCode,code:e},a=await u.A.post(this.URL+"buy/card",i,{headers:{token:localStorage.getItem("token")??""},signal:this.axiosC.signal})}catch(i){return this.$root.loading(!1),void(u.A.isCancel&&u.A.isCancel(i)||"CanceledError"===i.name?console.log("用户取消请求"):this.$root.netError(i))}this.$root.loading(!1),1==a?.data?.code||0==a?.data?.code?t||0!=a?.data?.code?(this.$notify.success({title:"提示",message:"卡密使用成功"}),this.form={code:"",cardCode:""},this.isConfirm=!1,this.closeConfirm(),this.$emit("finish",!0)):this.alertContent=a?.data?.msg:this.$notify.error({title:"提示",message:a?.data?.msg})}},mounted(){}},Ie=Pe,Be=(0,v.A)(Ie,Ae,Te,!1,null,"5532e2b2",null),Ee=Be.exports,Re={name:"userPage",components:{userData:Dt,useCard:Ee,pageLib:zt,buttonLib:b,dialogLib:T,VueHcaptcha:h()},data(){return{activeName:"userdata",userInfo:null,cardsData:[],totalPage:1,currentPage:1,limit:10,loading:!1,URL:window.config.apiUrl,axiosC:new AbortController,sort:"status",order:"asc",searchCode:"",isShowChangepwd:!1,changepwdForm:{code:"",newpwd:"",confirmpwd:""},isShowChangeemail:!1,changeemailForm:{code:"",newcode:"",email:""},isOpenTrafficAlert:!1,isOpenEXPAlert:!1,isShowHcaptcha:!1,hCaptchaType:"changepwd",hCaptchaKey:window.config.hCaptcha,notifyConfigForm:{traffic:200,cardday:3}}},watch:{searchCode:"debouncedGetData",userInfo:{handler(t){t?(this.isOpenTrafficAlert=t?.traffic_alert>0,this.isOpenEXPAlert=t?.cards_alert>0,this.notifyConfigForm={traffic:t?.traffic_alert>0?t?.traffic_alert/1024:0,cardday:t?.cards_alert>0?t?.cards_alert:0}):(this.isOpenTrafficAlert=!1,this.isOpenEXPAlert=!1,this.notifyConfigForm={traffic:0,cardday:0})},deep:!0,immediate:!0},isOpenTrafficAlert:function(t){t||(this.notifyConfigForm.traffic=0,this.saveNotifyConfig())},isOpenEXPAlert:function(t){t||(this.notifyConfigForm.cardday=0,this.saveNotifyConfig())}},methods:{async saveNotifyConfig(){let t=null;try{t=await u.A.post(this.URL+"/user/changeNotice",this.notifyConfigForm,{signal:this.axiosC.signal,headers:{token:localStorage.getItem("token")??""}})}catch(e){return u.A.isCancel&&u.A.isCancel(e)||"CanceledError"===e.name?console.log("用户取消请求"):this.$root.netError(e),void this.closeChangeEmail()}this.$notify.error({title:"提示",message:t?.data?.msg})},async changeEmail(){if(""==this.changeemailForm.code||""==this.changeemailForm.newcode||""==this.changeemailForm.email)return void this.$notify.error({title:"提示",message:"请填写完整信息"});this.$root.loading(!0);let t=null,e={code:this.changeemailForm.code,newcode:this.changeemailForm.newcode,email:this.changeemailForm.email};try{t=await u.A.post(this.URL+"/user/changeemail",e,{headers:{token:localStorage.getItem("token")??""},signal:this.axiosC.signal})}catch(a){return this.$root.loading(!1),u.A.isCancel&&u.A.isCancel(a)||"CanceledError"===a.name?console.log("用户取消请求"):this.$root.netError(a),void this.closeChangeEmail()}this.closeChangeEmail(),this.$root.loading(!1),this.$notify.error({title:"提示",message:t?.data?.msg})},closeChangeEmail(){this.changeemailForm={code:"",newcode:"",email:""},this.$refs?.changeemail?.hide()},closeChangePwd(){this.changepwdForm={code:"",newpwd:"",confirmpwd:""},this.$refs?.changepwd?.hide()},async changepwd(){if(""==this.changepwdForm.code||""==this.changepwdForm.newpwd||""==this.changepwdForm.confirmpwd)return void this.$notify.error({title:"提示",message:"请填写完整信息"});if(this.changepwdForm.newpwd!=this.changepwdForm.confirmpwd)return void this.$notify.error({title:"提示",message:"两次输入的密码不一致"});this.$root.loading(!0);let t=null,e={code:this.changepwdForm.code,newpassword:this.changepwdForm.newpwd};try{t=await u.A.post(this.URL+"/user/changepwd",e,{headers:{token:localStorage.getItem("token")??""},signal:this.axiosC.signal})}catch(a){return this.$root.loading(!1),u.A.isCancel&&u.A.isCancel(a)||"CanceledError"===a.name?console.log("用户取消请求"):this.$root.netError(a),void this.closeChangePwd()}this.closeChangePwd(),this.$root.loading(!1),this.$notify.error({title:"提示",message:t?.data?.msg})},async sendEmailCode(t="",e=""){this.$root.loading(!0);let a=null,i={id:t,code:e};"changeemailS2"==t&&(i.email=this.changeemailForm.email);try{a=await u.A.post(this.URL+"/user/sendMail",i,{headers:{token:localStorage.getItem("token")??""},signal:this.axiosC.signal})}catch(s){return this.$root.loading(!1),void(u.A.isCancel&&u.A.isCancel(s)||"CanceledError"===s.name?console.log("用户取消请求"):this.$root.netError(s))}this.$root.loading(!1),this.$notify.error({title:"提示",message:a?.data?.msg})},getpwdToken(){this.isShowHcaptcha=!0,this.hCaptchaType="changepwd"},getemailToken(t=""){this.isShowHcaptcha=!0,this.hCaptchaType=t},closeHcaptcha(){this.isShowHcaptcha=!1},async hcapResult(t){t&&(this.$refs?.hcaptcha?.hide(),this.sendEmailCode(this.hCaptchaType,t))},sortChange(t){this.sort=t.prop,"level_text"==t.prop&&(this.sort="level_id"),"descending"==t.order?this.order="desc":this.order="asc",this.getData()},formatTraffic(t=0,e=0){e||(e=0),t||(t=0);let a=0;return t>e&&(a=Math.floor((t-e)/t*100)),{str:a+"% ("+(t-e)+"MB/"+t+"MB)",value:a}},reloadData(){this.getData(),this.getUserInfo()},changePage(t){this.currentPage=t,this.getData(t)},async getData(t=1,e=10){this.loading=!0;let a=null;try{a=await u.A.get(this.URL+"buy/getUserCardList?page="+t+"&limit="+e+"&code="+this.searchCode+"&status=&sort="+this.sort+"&order="+this.order,{headers:{token:localStorage.getItem("token")??""},signal:this.axiosC.signal})}catch(i){return this.loading=!1,void(u.A.isCancel&&u.A.isCancel(i)||"CanceledError"===i.name?console.log("用户取消请求"):this.$root.netError(i))}this.loading=!1,1==a?.data?.code?(this.totalPage=a?.data?.data?.last_page??1,this.cardsData=a?.data?.data?.data??[]):this.$notify.error({title:"提示",message:a?.data?.msg})},async getUserInfo(){let t=await this.$root.checkLogin();t||("/"!=this.$route.path&&this.$router.replace("/"),this.$root.goLogin()),this.userInfo=t?.data??null},debouncedGetData:function(){let t=null;return function(){t&&clearTimeout(t),t=setTimeout((()=>{this.getData(1,this.limit)}),500)}}()},mounted(){this.$nextTick((()=>{this.getUserInfo(),this.getData()}))},beforeDestroy(){this.axiosC.abort()}},Ne=Re,Ue=(0,v.A)(Ne,De,Fe,!1,null,"8405398e",null),He=Ue.exports,Oe=function(){var t=this,e=t._self._c;return e("div",{staticClass:"page",attrs:{id:"mallPage"}},[t._v(" 商城页 ")])},Me=[],ze={name:"mallPage",data(){return{}},methods:{},mounted(){}},Ge=ze,je=(0,v.A)(Ge,Oe,Me,!1,null,"b2bf8684",null),qe=je.exports,Ke=function(){var t=this,e=t._self._c;return e("div",{staticClass:"page",attrs:{id:"helpPage"}},[t._v(" 帮助页 ")])},We=[],Xe={name:"helpPage",data(){return{}},methods:{},mounted(){}},Ve=Xe,Ye=(0,v.A)(Ve,Ke,We,!1,null,"098c6e2a",null),Ze=Ye.exports,Je=function(){var t=this,e=t._self._c;return e("div",{staticClass:"serverStatus page"},[e("div",{staticClass:"card"},[e("div",{staticClass:"cardTitle"},[t._v("服务器状态")]),e("div",{staticClass:"toolsBar"},[t._m(0),e("div",{staticClass:"row"},[e("el-select",{attrs:{"collapse-tags":"",placeholder:"请选择服务器分组"},model:{value:t.groupFilter,callback:function(e){t.groupFilter=e},expression:"groupFilter"}},[e("el-option",{attrs:{label:"全部",value:"all"}}),t._l(t.gourps,(function(t){return e("el-option",{key:t.value,attrs:{label:t.label,value:t.value}})}))],2),e("el-select",{attrs:{multiple:"","collapse-tags":"",placeholder:"请选择协议"},model:{value:t.protocolFilter,callback:function(e){t.protocolFilter=e},expression:"protocolFilter"}},t._l(t.protocols,(function(t){return e("el-option",{key:t.value,attrs:{label:t.label,value:t.value}})})),1)],1),e("div",{staticClass:"row"},[e("el-alert",{attrs:{title:"服务器负载展示过去5分钟内的服务器平均负载",type:"info",closable:!1}})],1),e("div",{staticClass:"row"},[e("el-alert",{attrs:{title:"若服务器状态为离线 则表示该服务器可能正在维护或遭受攻击",type:"info",closable:!1}})],1),t._m(1)]),e("div",{class:t.loading?"tableBox loadingLocal":"tableBox"},[0==t.tableData.length?e("div",{staticClass:"empty"}):t._e(),t._l(t.tableData,(function(a,i){return e("div",{key:"tableData_"+i,staticClass:"tableLine"},[e("el-table",{staticStyle:{width:"100%"},attrs:{data:[a],border:"","show-header":!1,"row-class-name":"tableTitle"}},[e("el-table-column",{attrs:{"class-name":"no-bottom-border",prop:"name",resizable:!1}})],1),e("el-table",{staticStyle:{width:"100%"},attrs:{data:[a],border:"",size:"mini"}},[e("el-table-column",{attrs:{prop:"checkStatus",width:"45",label:"状态",resizable:!1},scopedSlots:t._u([{key:"default",fn:function(a){return[a.row.checkStatus?e("i",{staticClass:"icon el-icon-success"}):t._e(),a.row.checkStatus?t._e():e("i",{staticClass:"icon el-icon-error"})]}}],null,!0)}),e("el-table-column",{attrs:{prop:"payload_load_5",label:"负载",resizable:!1},scopedSlots:t._u([{key:"default",fn:function(a){return[e("el-progress",{attrs:{color:t.payloadColor,"define-back-color":a.row.payloadBackColor,"stroke-width":16,percentage:a.row.payload_load_5,"text-inside":!0}})]}}],null,!0)}),e("el-table-column",{attrs:{prop:"payload_time",width:"70",label:"连续运行",resizable:!1}})],1)],1)})),e("div",{staticClass:"pagenation"},[e("pageLib",{attrs:{total:t.totalPage,page:t.currentPage},on:{change:t.changePage}})],1)],2)])])},Qe=[function(){var t=this,e=t._self._c;return e("div",{staticClass:"row"},[e("div",{staticClass:"title"},[t._v("搜索")])])},function(){var t=this,e=t._self._c;return e("div",{staticClass:"row",staticStyle:{"margin-top":"5px"}},[e("i",{staticClass:"icon el-icon-error"},[t._v(" 离线")]),e("i",{staticClass:"icon el-icon-success"},[t._v(" 在线")])])}],ta={name:"serverStatus",components:{pageLib:zt},data(){return{URL:window.config.apiUrl,loading:!1,payloadColor:[{color:"#5cb87a",percentage:40},{color:"#e6a23c",percentage:70},{color:"#f56c6c",percentage:100}],currentPage:1,totalPage:1,limit:10,tableData:[],axiosC:new AbortController,gourps:[],groupFilter:"",protocols:[],protocolFilter:[]}},computed:{},watch:{groupFilter:"debouncedGetServersData",protocolFilter:"debouncedGetServersData"},methods:{changePage(t){this.getServerData(t,this.limit)},async getServerData(t=1,e=10){this.loading=!0;let a=null;this.currentPage=t;let i="",s=[];0==this.protocolFilter.length?this.protocols.forEach((t=>{s.push(t.value)})):this.protocolFilter.forEach((t=>{s.push(t)})),i=s.join(",");let o=this.groupFilter,l={};l=""!=o&&"all"!=o?{protocol:i,group:o}:{protocol:i},l.page=t,l.limit=e;try{a=await u.A.post(this.URL+"frp/serverList",l,{headers:{token:localStorage.getItem("token")},signal:this.axiosC.signal})}catch(r){this.loading=!1,this.$root.netError(r)}this.loading=!1,this.tableData=a?.data?.data?.data,this.tableData.forEach((t=>{t?.payload_load_5<40&&(t.payloadBackColor="#5cb87a33"),t?.payload_load_5<70&&t?.payload_load_5>=40&&(t.payloadBackColor="#e6a23c33"),t?.payload_load_5>70&&(t.payloadBackColor="#f56c6c33");let e=(new Date).getTime(),a=1e3*t.updatetime;e-a>66e4&&(t.checkStatus=!1),e-a<66e4&&(t.checkStatus=!0)}));let n=a?.data?.data?.selection;this.gourps=n?.goups,this.protocols=n?.protocols,this.totalPage=a?.data?.data?.last_page},async getData(){let t=null;this.loading=!0;try{let e={protocol:""};t=await u.A.post(this.URL+"frp/serverList",e,{headers:{token:localStorage.getItem("token")},signal:this.axiosC.signal})}catch(a){this.$root.netError(a)}let e=t?.data?.data?.selection;this.protocols=e?.protocols,this.getServerData(1,this.limit)},debouncedGetServersData:function(){let t=null;return function(){t&&clearTimeout(t),t=setTimeout((()=>{this.getServerData()}),500)}}()},mounted(){this.$nextTick((()=>{this.getData()}))},beforeDestroy(){this.axiosC.abort()}},ea=ta,aa=(0,v.A)(ea,Je,Qe,!1,null,"63e2e0ac",null),ia=aa.exports;i["default"].use(gt.Ay);const sa=[{path:"/",name:"HomePage",component:wt},{path:"/usercenter",name:"UserCenterPage",component:ie},{path:"/tunnel",name:"TunnelPage",component:ce},{path:"/servers",name:"ServerStatus",component:ia},{path:"/download",name:"DownloadPage",component:pe},{path:"/domainauth",name:"DomainAuthPage",component:_e},{path:"/ticket",name:"TicketPage",component:Se},{path:"/mall",name:"MallPage",component:qe},{path:"/user",name:"UserPage",component:He},{path:"/help",name:"HelpPage",component:Ze},{path:"*",redirect:"/"}],oa=new gt.Ay({mode:"hash",routes:sa});var la=oa,na=a(3372),ra=a.n(na);window.config={backendUrl:"http://8.148.189.56:8898/",apiUrl:"http://8.148.189.56:8898/index.php/api/",hCaptcha:"a79e783e-18ec-4f22-9352-f1e85ed42380",pcPage:"http://8.148.189.56:8868/",DEBUG:!1},i["default"].config.productionTip=!1,i["default"].use(ut()),i["default"].use(ra(),{name:"v-touch"}),new i["default"]({router:la,render:t=>t(dt)}).$mount("#app")}},e={};function a(i){var s=e[i];if(void 0!==s)return s.exports;var o=e[i]={id:i,loaded:!1,exports:{}};return t[i].call(o.exports,o,o.exports,a),o.loaded=!0,o.exports}a.m=t,function(){a.amdO={}}(),function(){var t=[];a.O=function(e,i,s,o){if(!i){var l=1/0;for(d=0;d<t.length;d++){i=t[d][0],s=t[d][1],o=t[d][2];for(var n=!0,r=0;r<i.length;r++)(!1&o||l>=o)&&Object.keys(a.O).every((function(t){return a.O[t](i[r])}))?i.splice(r--,1):(n=!1,o<l&&(l=o));if(n){t.splice(d--,1);var c=s();void 0!==c&&(e=c)}}return e}o=o||0;for(var d=t.length;d>0&&t[d-1][2]>o;d--)t[d]=t[d-1];t[d]=[i,s,o]}}(),function(){a.n=function(t){var e=t&&t.__esModule?function(){return t["default"]}:function(){return t};return a.d(e,{a:e}),e}}(),function(){a.d=function(t,e){for(var i in e)a.o(e,i)&&!a.o(t,i)&&Object.defineProperty(t,i,{enumerable:!0,get:e[i]})}}(),function(){a.g=function(){if("object"===typeof globalThis)return globalThis;try{return this||new Function("return this")()}catch(t){if("object"===typeof window)return window}}()}(),function(){a.o=function(t,e){return Object.prototype.hasOwnProperty.call(t,e)}}(),function(){a.r=function(t){"undefined"!==typeof Symbol&&Symbol.toStringTag&&Object.defineProperty(t,Symbol.toStringTag,{value:"Module"}),Object.defineProperty(t,"__esModule",{value:!0})}}(),function(){a.nmd=function(t){return t.paths=[],t.children||(t.children=[]),t}}(),function(){a.p="/"}(),function(){var t={524:0};a.O.j=function(e){return 0===t[e]};var e=function(e,i){var s,o,l=i[0],n=i[1],r=i[2],c=0;if(l.some((function(e){return 0!==t[e]}))){for(s in n)a.o(n,s)&&(a.m[s]=n[s]);if(r)var d=r(a)}for(e&&e(i);c<l.length;c++)o=l[c],a.o(t,o)&&t[o]&&t[o][0](),t[o]=0;return a.O(d)},i=self["webpackChunkvue2template"]=self["webpackChunkvue2template"]||[];i.forEach(e.bind(null,0)),i.push=e.bind(null,i.push.bind(i))}();var i=a.O(void 0,[504],(function(){return a(3534)}));i=a.O(i)})();
//# sourceMappingURL=app.fea5097c.js.map